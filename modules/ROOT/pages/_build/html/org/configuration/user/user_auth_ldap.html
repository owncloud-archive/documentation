<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>User Authentication with LDAP &#8212; ownCloud 10.0.8 Server Administration Manual 10.0.8 documentation</title>
    <link rel="stylesheet" href="../../_static/" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/main.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/styles.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="User Provisioning API" href="user_provisioning_api.html" />
    <link rel="prev" title="User Authentication with IMAP, SMB, and FTP" href="user_auth_ftp_smb_imap.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#1d2d44">
<link rel="shortcut icon" href="https://owncloud.org/wp-content/themes/owncloudorgnew/assets/img/common/favicon.png" />
<link rel="apple-touch-icon-precomposed" href="https://owncloud.org/wp-content/themes/owncloudorgnew/assets/img/common/favicon.png" />

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https//piwik.owncloud.org/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '4']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->

  </head><body>
<noscript><p><img src="https://piwik.owncloud.com/piwik.php?idsite=4&rec=1" style="border:0" alt=""></p></noscript>

<header class="banner navbar navbar-default navbar-static-top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="brand" href="http://owncloud.org/" rel="home" title="ownCloud.org"><img class="logo" src="../../_static/img/logo_owncloud.svg" itemprop="logo"></a>
    </div>

    <nav class="collapse navbar-collapse" role="navigation">
      <ul id="menu-header" class="nav navbar-nav">
        <li class="menu-news"><a href="https://owncloud.org/news/">News</a></li>
        <li class="menu-features"><a href="https://owncloud.org/features/">Features</a></li>
        <li class="menu-demo"><a target="_blank" href="https://demo.owncloud.org">Demo</a></li>
        <li class="menu-documentation top-nav-active"><a href="https://doc.owncloud.org">Documentation</a></li>
        <li class="menu-contribute"><a href="https://owncloud.org/contribute/">Contribute</a>
        <li class="menu-support"><a href="https://owncloud.org/support">Support</a></li>
        <li class="menu-commercial"><a target="_blank" href="https://owncloud.com">Enterprise Edition</a></li>
        <li class="menu-install"><a href="https://owncloud.org/install/">Download</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="wrap container not-front">
  <div class="content row">
  <main class="main">
    <div class="row page-content-header">
      <div class="col-md-6">
        <h1><a href="../../contents.html">ownCloud 10.0.8 Server Administration Manual</a></h1>
      </div>
      <div class="col-md-5 col-md-offset-1">
      
        <form class="headersearch" style="margin-bottom:-3px;" action="../../search.html" method="get">
        <input type="text" value="" name="q" id="q" class="form-control" />
        <button  class="btn btn-default" type="submit" id="searchsubmit">Search</button>
        </form>
      
      </div>
    </div>
    
			<div class="row">
				<div class="col-md-3">
					<div class="sidebar">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>

<li><a href="../../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new_admin.html">What’s New in ownCloud 10.0.8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../database/index.html">Database Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../files/index.html">File Sharing and Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ldap/ldap_proxy_cache_server_setup.html">How To Install and Configure an LDAP Proxy-Cache Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mimetypes/index.html">Mimetypes Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../server/index.html">Server Configuration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">User Management</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="user_configuration.html">User Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset_admin_password.html">Resetting a Lost Admin Password</a></li>
<li class="toctree-l3"><a class="reference internal" href="reset_user_password.html">Resetting a User Password</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_auth_ftp_smb_imap.html">User Authentication with IMAP, SMB, and FTP</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">User Authentication with LDAP</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_provisioning_api.html">User Provisioning API</a></li>
<li class="toctree-l3"><a class="reference internal" href="user_roles.html">ownCloud Roles</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appliance/index.html">The ownCloud X Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

								</ul>
							</div>
					</div>
				</div>
        

				<div class="col-md-9">
					<div class="page-content">
            
<ul class="prevnext-title list-unstyled list-inline">
  <li class="prev">
    <a href="user_auth_ftp_smb_imap.html" title="Previous Chapter: User Authentication with IMAP, SMB, and FTP"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; User Authenti...</span>
    </a>
  </li>
  <li class="next">
    <a href="user_provisioning_api.html" title="Next Chapter: User Provisioning API"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">User Provisioning API &raquo;</span>
    </a>
  </li>
</ul>
						
  <div class="section" id="user-authentication-with-ldap">
<h1>User Authentication with LDAP<a class="headerlink" href="#user-authentication-with-ldap" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please check both the advanced and expert configurations carefully before using in production</p>
</div>
<p>ownCloud ships with an LDAP application which allows LDAP users (including Active Directory) to appear in your ownCloud user listings.
These users will authenticate to ownCloud with their LDAP credentials, so you don’t have to create separate ownCloud user accounts for them.
You will manage their ownCloud group memberships, quotas, and sharing permissions just like any other ownCloud user.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The PHP LDAP module is required. It is supplied by php7.1-ldap on
Debian/Ubuntu and php-ldap on CentOS/Red Hat/Fedora. Please check for the
correct version, based on your installation of PHP.</p>
</div>
<p>The LDAP application supports:</p>
<ul class="simple">
<li>LDAP group support</li>
<li>File sharing with ownCloud users and groups</li>
<li>Access via WebDAV and ownCloud Desktop Client</li>
<li>Versioning, external Storage and all other ownCloud features</li>
<li>Seamless connectivity to Active Directory, with no extra configuration
required</li>
<li>Support for primary groups in Active Directory</li>
<li>Auto-detection of LDAP attributes such as base DN, email, and the LDAP server
port number</li>
<li>Only read access to your LDAP (edit or delete of users on your LDAP is not
supported)</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The LDAP app is not compatible with the <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">backend</span> <span class="pre">using</span> <span class="pre">remote</span>
<span class="pre">HTTP</span> <span class="pre">servers</span></code> app. You cannot use both of them at the same time.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A non-blocking or correctly configured <a class="reference external" href="https://selinuxproject.org/page/Main_Page">SELinux</a> setup is needed
for the LDAP backend to work. Please refer to the <a class="reference internal" href="../../installation/selinux_configuration.html#selinux-config-label"><span class="std std-ref">SELinux Configuration</span></a>.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>First, enable the <code class="docutils literal notranslate"><span class="pre">LDAP</span> <span class="pre">user</span> <span class="pre">and</span> <span class="pre">group</span> <span class="pre">backend</span></code> app on the Apps page in ownCloud.
Then, go to your Admin page to configure it.
The LDAP configuration panel has four tabs.
A correctly completed first tab (“Server”) is mandatory to access the other tabs.
A green indicator lights when the configuration is correct.
Hover your cursor over the fields to see some pop-up tooltips.</p>
<div class="section" id="server-tab">
<h3>Server Tab<a class="headerlink" href="#server-tab" title="Permalink to this headline">¶</a></h3>
<p>Start with the Server tab.
You may configure multiple servers if you have them.
At a minimum you must supply the LDAP server’s hostname.
If your server requires authentication, enter your credentials on this tab.
ownCloud will then attempt to auto-detect the server’s port and base DN.
The base DN and port are mandatory, so if ownCloud cannot detect them you must enter them manually.</p>
<div class="figure">
<img alt="LDAP wizard, server tab" src="../../_images/ldap-wizard-1-server.png" />
</div>
<dl class="docutils">
<dt>Server configuration:</dt>
<dd>Configure one or more LDAP servers.
Click the  “<strong>Delete Configuration</strong>” button to remove the active configuration.</dd>
<dt>Host:</dt>
<dd><p class="first">The host name or IP address of the LDAP server.
It can also be an <strong>ldaps://</strong> URI.
If you enter the port number, it speeds up server detection.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">directory.my-company.com</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ldaps://directory.my-company.com</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">directory.my-company.com:9876</span></code></li>
</ul>
</dd>
<dt>Port:</dt>
<dd><p class="first">The port on which to connect to the LDAP server.
The field is disabled in the beginning of a new configuration.
If the LDAP server is running on a standard port, the port will be detected automatically.
If you are using a non-standard port, ownCloud will attempt to detect it.
If this fails you must enter the port number manually.</p>
<p>Example:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">389</span></code></li>
</ul>
</dd>
<dt>User DN:</dt>
<dd><p class="first">The name as DN of a user who has permissions to do searches in the LDAP directory.
Leave it empty for anonymous access.
We recommend that you have a special LDAP system user for this.</p>
<p>Example:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">uid=owncloudsystemuser,cn=sysusers,dc=my-company,dc=com</span></code></li>
</ul>
</dd>
<dt>Password:</dt>
<dd>The password for the user given above.
Empty for anonymous access.</dd>
<dt>Base DN:</dt>
<dd><p class="first">The base DN of LDAP, from where all users and groups can be reached.
You may enter multiple base DNs, one per line.
Base DNs for users and groups can be set in the Advanced tab.
This field is mandatory.
ownCloud attempts to determine the Base DN according to the provided User DN or the provided Host, and you must enter it manually if ownCloud does not detect it.</p>
<p>Example:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">dc=my-company,dc=com</span></code></li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="user-filter">
<h3>User Filter<a class="headerlink" href="#user-filter" title="Permalink to this headline">¶</a></h3>
<p>Use this to control which LDAP users are listed as ownCloud users on your ownCloud server.
In order to control which LDAP users can login to your ownCloud server use the Login filter.
Those LDAP users who have access but are not listed as users (if there are any) will be hidden users.
You may bypass the form fields and enter a raw LDAP filter if you prefer.</p>
<div class="figure">
<img alt="User filter" src="../../_images/ldap-wizard-2-user.png" />
</div>
<dl class="docutils">
<dt>Only those object classes:</dt>
<dd>ownCloud will determine the object classes that are typically available for
user objects in your LDAP. ownCloud will automatically select the object
class that returns the highest amount of users. You may select multiple
object classes.</dd>
<dt>Only from those groups:</dt>
<dd>If your LDAP server supports the <code class="docutils literal notranslate"><span class="pre">memberof-overlay</span></code> in LDAP filters, you
can define that only users from one or more certain groups are allowed to
appear in user listings in ownCloud.
By default, no value will be selected.
You may select multiple groups.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Group membership is configured by adding <cite>memberUid</cite>, <cite>uniqueMember</cite> or
<cite>member</cite> attributes to an ldap group (see <a class="reference internal" href="#group-member-association"><span class="std std-ref">Group Member association</span></a>) below. In order to efficiently look up the
groups a user who is a member of the LDAP server must support
a <code class="docutils literal notranslate"><span class="pre">memberof-overlay</span></code>. It allows using the virtual <code class="docutils literal notranslate"><span class="pre">memberOf</span></code> or
<code class="docutils literal notranslate"><span class="pre">isMemberOf</span></code> attributes of an LDAP user in the user filter. If your LDAP
server does not support the <code class="docutils literal notranslate"><span class="pre">memberof-overlay</span></code> in LDAP filters, the input
field is disabled. Please contact your LDAP administrator.</p>
<ul class="last simple">
<li>Active Directory uses <a class="reference external" href="https://msdn.microsoft.com/en-us/library/ms677943.aspx#memberOf">memberOf</a> and is enabled by default.</li>
<li>OpenLDAP uses <code class="docutils literal notranslate"><span class="pre">memberOf</span></code>. <a class="reference external" href="https://www.openldap.org/doc/admin24/overlays.html#Reverse%20Group%20Membership%20Maintenance">Reverse Group Membership Maintenance</a> needs to be enabled.</li>
<li>Oracle uses <a class="reference external" href="https://docs.oracle.com/cd/E29127_01/doc.111170/e28967/ismemberof-5dsat.htm">isMemberOf</a> and is enabled by default.</li>
</ul>
</div>
<dl class="docutils">
<dt>Edit raw filter instead:</dt>
<dd><p class="first">Clicking on this text toggles the filter mode and you can enter the raw LDAP filter directly.
Example:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">objectClass</span><span class="o">=</span><span class="n">inetOrgPerson</span><span class="p">)(</span><span class="n">memberOf</span><span class="o">=</span><span class="n">cn</span><span class="o">=</span><span class="n">owncloudusers</span><span class="p">,</span><span class="n">ou</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt>x users found:</dt>
<dd>This is an indicator that tells you approximately how many users will be listed in ownCloud.
The number updates automatically after any changes.</dd>
</dl>
</div>
<div class="section" id="login-filter">
<h3>Login Filter<a class="headerlink" href="#login-filter" title="Permalink to this headline">¶</a></h3>
<p>The settings in the Login Filter tab determine which LDAP users can log in to your ownCloud system and which attribute or attributes the provided login name is matched against (e.g., LDAP/AD username, email address).
You may select multiple user details.
You may bypass the form fields and enter a raw LDAP filter if you prefer.</p>
<p>You may override your User Filter settings on the User Filter tab by using a raw LDAP filter.</p>
<div class="figure">
<img alt="Login filter" src="../../_images/ldap-wizard-3-login.png" />
</div>
<dl class="docutils">
<dt>LDAP Username:</dt>
<dd>If this value is checked, the login value will be compared to the username in the LDAP directory.
The corresponding attribute, usually <code class="docutils literal notranslate"><span class="pre">uid</span></code> or <code class="docutils literal notranslate"><span class="pre">samaccountname</span></code> will be detected automatically by ownCloud.</dd>
<dt>LDAP Email Address:</dt>
<dd>If this value is checked, the login value will be compared to an email address in the LDAP directory; specifically, the <code class="docutils literal notranslate"><span class="pre">mailPrimaryAddress</span></code> and <code class="docutils literal notranslate"><span class="pre">mail</span></code> attributes.</dd>
<dt>Other Attributes:</dt>
<dd>This multi-select box allows you to select other attributes for the comparison.
The list is generated automatically from the user object attributes in your LDAP server.</dd>
<dt>Edit raw filter instead:</dt>
<dd><p class="first">Clicking on this text toggles the filter mode and you can enter the raw LDAP
filter directly.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">%uid</span></code> placeholder is replaced with the login name entered by the
user upon login.</p>
<p>Examples:</p>
<ul class="last">
<li><p class="first">only username:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">objectClass</span><span class="o">=</span><span class="n">inetOrgPerson</span><span class="p">)(</span><span class="n">memberOf</span><span class="o">=</span><span class="n">cn</span><span class="o">=</span><span class="n">owncloudusers</span><span class="p">,</span><span class="n">ou</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span><span class="p">)(</span><span class="n">uid</span><span class="o">=%</span><span class="n">uid</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">username or email address:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="o">&amp;</span><span class="p">(</span><span class="n">objectClass</span><span class="o">=</span><span class="n">inetOrgPerson</span><span class="p">)(</span><span class="n">memberOf</span><span class="o">=</span><span class="n">cn</span><span class="o">=</span><span class="n">owncloudusers</span><span class="p">,</span><span class="n">ou</span><span class="o">=</span><span class="n">groups</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span><span class="p">)(</span><span class="o">|</span><span class="p">(</span><span class="n">uid</span><span class="o">=%</span><span class="n">uid</span><span class="p">)(</span><span class="n">mail</span><span class="o">=%</span><span class="n">uid</span><span class="p">)))</span>
</pre></div>
</div>
</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="group-filter">
<h3>Group Filter<a class="headerlink" href="#group-filter" title="Permalink to this headline">¶</a></h3>
<p>By default, no LDAP groups will be available in ownCloud.
The settings in the group filter tab determine which groups will be available in ownCloud.
You may also elect to enter a raw LDAP filter instead.</p>
<div class="figure">
<img alt="Group filter" src="../../_images/ldap-wizard-4-group.png" />
</div>
<dl class="docutils">
<dt>Only those object classes:</dt>
<dd>ownCloud will determine the object classes that are typically available for group objects in your LDAP server.
ownCloud will only list object classes that return at least one group object.
You can select multiple object classes.
A typical object class is <code class="docutils literal notranslate"><span class="pre">group</span></code>, or <code class="docutils literal notranslate"><span class="pre">posixGroup</span></code>.</dd>
<dt>Only from those groups:</dt>
<dd>ownCloud will generate a list of available groups found in your LDAP server.
From these groups, you can select the group or groups that get access to your ownCloud server.</dd>
<dt>Edit raw filter instead:</dt>
<dd><p class="first">Clicking on this text toggles the filter mode and you can enter the raw LDAP filter directly.</p>
<p>Example:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">objectClass=group</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">objectClass=posixGroup</span></code></li>
</ul>
</dd>
<dt>y groups found:</dt>
<dd>This tells you approximately how many groups will be available in ownCloud.
The number updates automatically after any change.</dd>
</dl>
</div>
</div>
<div class="section" id="advanced-settings">
<h2>Advanced Settings<a class="headerlink" href="#advanced-settings" title="Permalink to this headline">¶</a></h2>
<p>The LDAP Advanced Setting section contains options that are not needed for a working connection.
This provides controls to disable the current configuration, configure replica hosts, and various performance-enhancing options.</p>
<p>The Advanced Settings are structured into three parts:</p>
<ul class="simple">
<li>Connection Settings</li>
<li>Directory Settings</li>
<li>Special Attributes</li>
</ul>
<div class="section" id="connection-settings">
<h3>Connection Settings<a class="headerlink" href="#connection-settings" title="Permalink to this headline">¶</a></h3>
<div class="figure">
<img alt="Advanced settings" src="../../_images/ldap-advanced-1-connection.png" />
</div>
<dl class="docutils">
<dt>Configuration Active:</dt>
<dd>Enables or Disables the current configuration.
By default, it is turned off.
When ownCloud makes a successful test connection it is automatically turned on.</dd>
<dt>Backup (Replica) Host:</dt>
<dd><p class="first">If you have a backup LDAP server, enter the connection settings here.
ownCloud will then automatically connect to the backup when the main server cannot be reached.
The backup server must be a replica of the main server so that the object UUIDs match.</p>
<p>Example:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">directory2.my-company.com</span></code></li>
</ul>
</dd>
<dt>Backup (Replica) Port:</dt>
<dd><p class="first">The connection port of the backup LDAP server.
If no port is given, but only a host, then the main port (as specified above) will be used.</p>
<p>Example:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">389</span></code></li>
</ul>
</dd>
<dt>Disable Main Server:</dt>
<dd>You can manually override the main server and make ownCloud only connect to the backup server.
This is useful for planned downtimes.</dd>
<dt>Turn off SSL certificate validation:</dt>
<dd>Turns off SSL certificate checking. Use it for testing only!</dd>
<dt>Cache Time-To-Live:</dt>
<dd><p class="first">A cache is introduced to avoid unnecessary LDAP traffic, for example caching usernames so they don’t have to be looked up for every page, and speeding up loading of the Users page.
Saving the configuration empties the cache.
The time is given in seconds.</p>
<p>Note that almost every PHP request requires a new connection to the LDAP server.
If you require fresh PHP requests we recommend defining a minimum lifetime of 15s or so, rather than completely eliminating the cache.</p>
<p>Examples:</p>
<ul class="last simple">
<li>Ten minutes: <code class="docutils literal notranslate"><span class="pre">600</span></code></li>
<li>One hour: <code class="docutils literal notranslate"><span class="pre">3600</span></code></li>
</ul>
</dd>
</dl>
<p>See the Caching section below for detailed information on how the cache operates.</p>
</div>
<div class="section" id="directory-settings">
<span id="ldap-directory-settings"></span><h3>Directory Settings<a class="headerlink" href="#directory-settings" title="Permalink to this headline">¶</a></h3>
<div class="figure">
<img alt="Directory settings." src="../../_images/ldap-advanced-2-directory.png" />
</div>
<dl class="docutils">
<dt>User Display Name Field:</dt>
<dd><p class="first">The attribute that should be used as display name in ownCloud.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">displayName</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">givenName</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">sn</span></code></li>
</ul>
</dd>
<dt>2nd User Display Name Field:</dt>
<dd><p class="first">An optional second attribute displayed in brackets after the display name, for example using the <code class="docutils literal notranslate"><span class="pre">mail</span></code> attribute displays as <code class="docutils literal notranslate"><span class="pre">Molly</span> <span class="pre">Foo</span> <span class="pre">(molly&#64;example.com)</span></code>.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">mail</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">userPrincipalName</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">sAMAccountName</span></code></li>
</ul>
</dd>
<dt>Base User Tree:</dt>
<dd><p class="first">The base DN of LDAP, from where all users can be reached.
This must be a complete DN, regardless of what you have entered for your Base DN in the Basic setting.
You can specify multiple base trees, one on each line.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">cn=programmers,dc=my-company,dc=com</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">cn=designers,dc=my-company,dc=com</span></code></li>
</ul>
</dd>
<dt>User Search Attributes:</dt>
<dd><p class="first">These attributes are used when searches for users are performed, for example in the share dialogue.
The user display name attribute is the default.
You may list multiple attributes, one per line.</p>
<p>If an attribute is not available on a user object, the user will not be listed, and will be unable to login.
This also affects the display name attribute.
If you override the default you must specify the display name attribute here.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">displayName</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">mail</span></code></li>
</ul>
</dd>
<dt>Group Display Name Field:</dt>
<dd><p class="first">The attribute that should be used as ownCloud group name.
ownCloud allows a limited set of characters (<code class="docutils literal notranslate"><span class="pre">a-zA-Z0-9.-_&#64;</span></code>).
Once a group name is assigned it cannot be changed.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">cn</span></code></li>
</ul>
</dd>
<dt>Base Group Tree:</dt>
<dd><p class="first">The base DN of LDAP, from where all groups can be reached.
This must be a complete DN, regardless of what you have entered for your Base DN in the Basic setting.
You can specify multiple base trees, one in each line.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">cn=barcelona,dc=my-company,dc=com</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">cn=madrid,dc=my-company,dc=com</span></code></li>
</ul>
</dd>
<dt>Group Search Attributes:</dt>
<dd><p class="first">These attributes are used when a search for groups is done, for example in the share dialogue.
By default the group display name attribute as specified above is used.
Multiple attributes can be given, one in each line.</p>
<p>If you override the default, the group display name attribute will not be taken into account, unless you specify it as well.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">cn</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">description</span></code></li>
</ul>
</dd>
</dl>
<dl class="docutils" id="group-member-association">
<dt>Group Member association:</dt>
<dd><p class="first">The attribute that is used to indicate group memberships, i.e., the attribute used by LDAP groups to refer to their users.
ownCloud detects the value automatically.
You should only change it if you have a very valid reason and know what you are doing.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">member</span></code> with FDN for Active Directory or for objectclass <code class="docutils literal notranslate"><span class="pre">groupOfNames</span></code> groups</li>
<li><code class="docutils literal notranslate"><span class="pre">memberUid</span></code> with RDN for objectclass <code class="docutils literal notranslate"><span class="pre">posixGroup</span></code> groups</li>
<li><code class="docutils literal notranslate"><span class="pre">uniqueMember</span></code> with FDN for objectclass <code class="docutils literal notranslate"><span class="pre">groupOfUniqueNames</span></code> groups</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Group Member association is used to efficiently query users of a certain
group, eg., on the userManagement page or when resolving all members of a group share.</p>
</div>
<dl class="docutils">
<dt>Dynamic Group Member URL</dt>
<dd>The LDAP attribute that on group objects contains an LDAP search URL that determines what objects belong to the group.
An empty setting disables dynamic group membership functionality.
See <a class="reference external" href="http://www.zytrax.com/books/ldap/ch11/dynamic.html">Configuring Dynamic Groups</a> for more details.</dd>
<dt>Nested Groups:</dt>
<dd>This makes the LDAP connector aware that groups could be stored inside existing group records.
By default a group will only contain users, so enabling this option isn’t necessary.
However, if groups are contained inside groups, and this option is not enabled, any groups contained within other groups will be ignored and not returned in search results.</dd>
<dt>Paging Chunk Size:</dt>
<dd>This sets the maximum number of records able to be returned in a response when ownCloud requests data from LDAP.
If this value is greater than the limit of the underlying LDAP server (such as 3000 for Microsoft Active Directory) the LDAP server will reject the request and the search request will fail.
Given that, it is important to set the requested chunk size to a value no larger than that which the underlying LDAP server supports.</dd>
</dl>
</div>
<div class="section" id="special-attributes">
<h3>Special Attributes<a class="headerlink" href="#special-attributes" title="Permalink to this headline">¶</a></h3>
<div class="figure">
<img alt="Special Attributes." src="../../_images/ldap-advanced-3-attributes.png" />
</div>
<dl class="docutils">
<dt>Quota Field:</dt>
<dd>The name of the LDAP attribute to retrieve the user quota limit from, e.g., <code class="docutils literal notranslate"><span class="pre">ownCloudQuota</span></code>.
<em>Note:</em> any quota set in LDAP overrides quotas set in ownCloud’s user management page.</dd>
<dt>Quota Default:</dt>
<dd>Override ownCloud’s default quota <em>for LDAP users</em> who do not have a quota set in the Quota Field, e.g., <code class="docutils literal notranslate"><span class="pre">15</span> <span class="pre">GB</span></code>.</dd>
</dl>
<p>Please bear in mind the following, when using these fields to assign user quota limits.
It should help to alleviate any, potential, confusion.</p>
<ol class="arabic simple">
<li>After installation ownCloud uses an unlimited quota by default.</li>
<li>Administrators can modify this value, at any time, in the user management page.</li>
<li>However, when an LDAP quota is set it will override any values set in ownCloud.</li>
<li>If an LDAP per/attribute quota is set, it will override the LDAP Quota Default value.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<blockquote>
<div>Administrators are not allowed to modify the user quota limit in the user management page when steps 3 or 4 are in effect.
At this point, updates are only possible via LDAP.</div></blockquote>
<p class="last">See the <a class="reference external" href="https://github.com/valerytschopp/owncloud-ldap-schema">LDAP Schema for OwnCloud Quota</a></p>
</div>
<dl class="docutils">
<dt>Email Field:</dt>
<dd>Set the user’s email from an LDAP attribute, e.g., <code class="docutils literal notranslate"><span class="pre">mail</span></code>.
Leave it empty for default behavior.</dd>
</dl>
<dl class="docutils" id="user-home-folder-naming-rule">
<dt>User Home Folder Naming Rule:</dt>
<dd><p class="first">By default, the ownCloud server creates the user directory in your ownCloud data directory and gives it the ownCloud username, e.g., <code class="docutils literal notranslate"><span class="pre">/var/www/owncloud/data/5a9df029-322d-4676-9c80-9fc8892c4e4b</span></code>, if your data directory is set to <code class="docutils literal notranslate"><span class="pre">/var/www/owncloud/data</span></code>.</p>
<p>It is possible to override this setting and name it after an LDAP attribute value, e.g., <code class="docutils literal notranslate"><span class="pre">attr:cn</span></code>.
The attribute can return either an absolute path, e.g., <code class="docutils literal notranslate"><span class="pre">/mnt/storage43/alice</span></code>, or a relative path which must not begin with a <code class="docutils literal notranslate"><span class="pre">/</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">CloudUsers/CookieMonster</span></code>.
This relative path is then created inside the data directory (e.g., <code class="docutils literal notranslate"><span class="pre">/var/www/owncloud/data/CloudUsers/CookieMonster</span></code>).</p>
<p>Since ownCloud 8.0.10 and up the home folder rule is enforced.
This means that once you set a home folder naming rule (get a home folder from an LDAP attribute), it must be available for all users.
If it isn’t available for a user, then that user will not be able to login.
Also, the filesystem will not be set up for that user, so their file shares will not be available to other users.
For older versions you may enforce the home folder rule with the <code class="docutils literal notranslate"><span class="pre">occ</span></code> command, like this example on Ubuntu:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">php</span> <span class="n">occ</span> <span class="n">config</span><span class="p">:</span><span class="n">app</span><span class="p">:</span><span class="nb">set</span> <span class="n">user_ldap</span> <span class="n">enforce_home_folder_naming_rule</span> <span class="o">--</span><span class="n">value</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p class="last">Since ownCloud 10.0 the home folder naming rule is only applied when first provisioning
the user.
This prevents data loss due to re-provisioning the users home folder in case of unintentional changes in LDAP.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="expert-settings">
<h2>Expert Settings<a class="headerlink" href="#expert-settings" title="Permalink to this headline">¶</a></h2>
<div class="figure">
<img alt="Expert settings." src="../../_images/ldap-expert.png" />
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the Expert Settings fundamental behavior can be adjusted to your needs. The
configuration should be well-tested before starting production use.</p>
</div>
<dl class="docutils">
<dt>Internal Username:</dt>
<dd><p class="first">The internal username is the identifier in ownCloud for LDAP users.
By default it will be created from the UUID attribute.
The UUID attribute ensures that the username is unique, and that characters do not need to be converted. Only these characters are allowed: <code class="docutils literal notranslate"><span class="pre">[\a-\zA-\Z0-\9_.&#64;-]</span></code>.
Other characters are replaced with their ASCII equivalents, or are simply omitted.</p>
<p>The LDAP backend ensures that there are no duplicate internal usernames in ownCloud, i.e., that it is checking all other activated user backends (including local ownCloud users).
On collisions a random number (between 1000 and 9999) will be attached to the retrieved value.
For example, if “alice” exists, the next username may be “alice_1337”.</p>
<p>The internal username is the default name for the user home folder in ownCloud.
It is also a part of remote URLs, for instance for all *DAV services.</p>
<p>You can override all of this with the Internal Username setting.
Leave it empty for default behavior.
Changes will affect only newly mapped LDAP users.</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">uid</span></code></li>
</ul>
</dd>
<dt>Override UUID detection</dt>
<dd><p class="first">By default, ownCloud auto-detects the UUID attribute.
The UUID attribute is used to uniquely identify LDAP users and groups.
The internal username will be created based on the UUID, if not specified otherwise.</p>
<p>You can override the setting and pass an attribute of your choice.
You must make sure that the attribute of your choice can be fetched for both users and
groups and it is unique.
Leave it empty for default behavior.
Changes will have effect only on newly mapped LDAP users and groups.</p>
<p>It also will have effect when a user’s or group’s DN changes and an old UUID was cached, which will result in a new user.
Because of this, the setting should be applied before putting ownCloud in production use and clearing the bindings (see the <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">and</span> <span class="pre">Group</span> <span class="pre">Mapping</span></code> section below).</p>
<p>Examples:</p>
<ul class="last simple">
<li><code class="docutils literal notranslate"><span class="pre">cn</span></code></li>
</ul>
</dd>
<dt>Username-LDAP User Mapping</dt>
<dd><p class="first">ownCloud uses usernames as keys to store and assign data.
In order to precisely identify and recognize users, each LDAP user will have a internal
username in ownCloud.
This requires a mapping from ownCloud username to LDAP user.
The created username is mapped to the UUID of the LDAP user.
Additionally the DN is cached as well to reduce LDAP interaction, but it is not used for identification. If the DN changes, the change will be detected by ownCloud by checking the UUID value.</p>
<p>The same is valid for groups.
The internal ownCloud name is used all over in ownCloud.
Clearing the Mappings will have leftovers everywhere.
Never clear the mappings in a production environment, but only in a testing or experimental server.</p>
<p class="last"><strong>Clearing the mappings is not configuration sensitive, it affects all LDAP configurations!</strong></p>
</dd>
</dl>
</div>
<div class="section" id="testing-the-configuration">
<h2>Testing the configuration<a class="headerlink" href="#testing-the-configuration" title="Permalink to this headline">¶</a></h2>
<p>The  “<strong>Test Configuration</strong>” button checks the values as currently given in the input fields.
You do not need to save before testing.
By clicking on the button, ownCloud will try to bind to the ownCloud server using the settings currently given in the input fields.
If the binding fails you’ll see a yellow banner with the error message:</p>
<blockquote>
<div>“The configuration is invalid. Please have a look at the logs for further details.”</div></blockquote>
<p>When the configuration test reports success, save your settings and check if the users and groups are fetched correctly on the Users page.</p>
</div>
<div class="section" id="syncing-users">
<h2>Syncing Users<a class="headerlink" href="#syncing-users" title="Permalink to this headline">¶</a></h2>
<p>While users who match the login and user filters can log in, only synced users will be found in the sharing dialog.
Whenever users log in their display name, email, quota, avatar and search attributes will be synced to ownCloud.
If you want to keep the metadata up to date you can set up a cron job, using <a class="reference internal" href="../server/occ_command.html#syncing-user-accounts-label"><span class="std std-ref">the occ command</span></a>.
Versions of ownCloud before 10.0 imported all users when the users page was loaded, but this is no longer the case.</p>
<p>We recommend <a class="reference internal" href="../server/background_jobs_configuration.html#cron-job-label"><span class="std std-ref">creating a Cron job</span></a>, to automate regularly syncing LDAP users with your ownCloud database.</p>
<div class="section" id="how-often-should-the-job-run">
<h3>How Often Should the Job Run?<a class="headerlink" href="#how-often-should-the-job-run" title="Permalink to this headline">¶</a></h3>
<p>This depends on the amount of users and speed of the update, but we recommend <em>at least</em> once per day.
You can run it more frequently, but doing so may generate too much load on the server.</p>
</div>
</div>
<div class="section" id="owncloud-avatar-integration">
<h2>ownCloud Avatar integration<a class="headerlink" href="#owncloud-avatar-integration" title="Permalink to this headline">¶</a></h2>
<p>ownCloud supports user profile pictures, which are also called avatars.
If a user has a photo stored in the <code class="docutils literal notranslate"><span class="pre">jpegPhoto</span></code> or <code class="docutils literal notranslate"><span class="pre">thumbnailPhoto</span></code> attribute on your LDAP server, it will be used as their avatar.
In this case the user cannot alter their avatar (on their Personal page) as it must be changed in LDAP. <code class="docutils literal notranslate"><span class="pre">jpegPhoto</span></code> is preferred over <code class="docutils literal notranslate"><span class="pre">thumbnailPhoto</span></code>.</p>
<div class="figure">
<img alt="Profile picture fetched from LDAP." src="../../_images/ldap-fetched-avatar.png" />
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">jpegPhoto</span></code> or <code class="docutils literal notranslate"><span class="pre">thumbnailPhoto</span></code> attribute is not set or empty, then users can upload and manage their avatars on their ownCloud Personal pages.
Avatars managed in ownCloud are not stored in LDAP.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">jpegPhoto</span></code> or <code class="docutils literal notranslate"><span class="pre">thumbnailPhoto</span></code> attribute is fetched once a day to make sure the current photo from LDAP is used in ownCloud. LDAP avatars override ownCloud avatars, and when an LDAP avatar is deleted then the most recent ownCloud avatar replaces it.</p>
<p>Photos served from LDAP are automatically cropped and resized in ownCloud.
This affects only the presentation, and the original image is not changed.</p>
</div>
<div class="section" id="troubleshooting-tips-and-tricks">
<h2>Troubleshooting, Tips and Tricks<a class="headerlink" href="#troubleshooting-tips-and-tricks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ssl-certificate-verification-ldaps-tls">
<h3>SSL Certificate Verification (LDAPS, TLS)<a class="headerlink" href="#ssl-certificate-verification-ldaps-tls" title="Permalink to this headline">¶</a></h3>
<p>A common mistake with SSL certificates is that they may not be known to PHP.
If you have trouble with certificate validation make sure that</p>
<ul class="simple">
<li>You have the certificate of the server installed on the ownCloud server</li>
<li>The certificate is announced in the system’s LDAP configuration file, usually  <code class="docutils literal notranslate"><span class="pre">/etc/ldap/ldap.conf</span></code>.</li>
</ul>
<ul class="simple">
<li>Using LDAPS, also make sure that the port is correctly configured (by default 636)</li>
<li>If you get the error “Lost connection to LDAP server” or “<strong>No connection to LDAP server</strong>” double check the connection parameters and try connecting to LDAP with tools like <code class="docutils literal notranslate"><span class="pre">ldapsearch</span></code>. If using ldaps or TLS make sure the certificate is readable by the user that is used to serve ownCloud.</li>
</ul>
</div>
<div class="section" id="microsoft-active-directory">
<h3>Microsoft Active Directory<a class="headerlink" href="#microsoft-active-directory" title="Permalink to this headline">¶</a></h3>
<p>Compared to earlier ownCloud versions, no further tweaks need to be done to make ownCloud work with Active Directory.
ownCloud will automatically find the correct configuration in the set-up process.</p>
</div>
<div class="section" id="memberof-read-memberof-permissions">
<h3>memberOf / Read MemberOf permissions<a class="headerlink" href="#memberof-read-memberof-permissions" title="Permalink to this headline">¶</a></h3>
<p>If you want to use <code class="docutils literal notranslate"><span class="pre">memberOf</span></code> within your filter you might need to give your querying user the permissions to use it.
For Microsoft Active Directory this is described <a class="reference external" href="https://serverfault.com/questions/167371/what-permissions-are-required-for-enumerating-users-groups-in-active-directory/167401#167401">here</a>.</p>
</div>
<div class="section" id="duplicating-server-configurations">
<h3>Duplicating Server Configurations<a class="headerlink" href="#duplicating-server-configurations" title="Permalink to this headline">¶</a></h3>
<p>In case you have a working configuration and want to create a similar one or “snapshot” configurations before modifying them you can do the following:</p>
<ol class="arabic simple">
<li>Go to the  “<strong>Server</strong>” tab</li>
<li>On  “<strong>Server Configuration</strong>” choose  “<strong>Add Server Configuration</strong>”</li>
<li>Answer the question “<strong>Take over settings from recent server configuration?</strong>”
with  “<strong>yes</strong>”.</li>
<li>(optional) Switch to  “<strong>Advanced</strong>” tab and uncheck  “<strong>Configuration Active</strong>”
in the “<strong>Connection Settings</strong>”, so the new configuration is not used on Save</li>
<li>Click on  “<strong>Save</strong>”</li>
</ol>
<p>Now you can modify and enable the configuration.</p>
</div>
</div>
<div class="section" id="performance-tips">
<h2>Performance tips<a class="headerlink" href="#performance-tips" title="Permalink to this headline">¶</a></h2>
<div class="section" id="caching">
<h3>Caching<a class="headerlink" href="#caching" title="Permalink to this headline">¶</a></h3>
<p>Using caching to speed up lookups.
See <a class="reference internal" href="../server/caching_configuration.html"><span class="doc">Memory Caching</span></a>.
The ownCloud cache is populated on demand, and remains populated until the “<strong>Cache Time-To-Live</strong>” for each unique request expires.
User logins are not cached, so if you need to improve login times set up a slave LDAP server to share the load.</p>
<p>You can adjust the “<strong>Cache Time-To-Live</strong>” value to balance performance and freshness of LDAP data.
All LDAP requests will be cached for 10 minutes by default, and you can alter this with the “<strong>Cache Time-To-Live</strong>” setting.
The cache answers each request that is identical to a previous request, within the time-to-live of the original request, rather than hitting the LDAP server.</p>
<p>The “<strong>Cache Time-To-Live</strong>” is related to each single request.
After a cache entry expires there is no automatic trigger for re-populating the information, as the cache is populated only by new requests, for example by opening the User administration page, or searching in a sharing dialog.</p>
<p>There is one trigger which is automatically triggered by a certain background job which keeps the <code class="docutils literal notranslate"><span class="pre">user-group-mappings</span></code> up-to-date, and always in cache.</p>
<p>Under normal circumstances, all users are never loaded at the same time.
Typically the loading of users happens while page results are generated, in steps of 30 until the limit is reached or no results are left.
For this to work on an oC-Server and LDAP-Server, “<strong>Paged Results</strong>” must be supported, which assumes PHP &gt;= 5.6.</p>
<p>ownCloud remembers which user belongs to which LDAP-configuration.
That means each request will always be directed to the right server unless a user is defunct, for example due to a server migration or unreachable server.
In this case the other servers will also receive the request.</p>
</div>
<div class="section" id="ldap-indexing">
<h3>LDAP indexing<a class="headerlink" href="#ldap-indexing" title="Permalink to this headline">¶</a></h3>
<p>Turn on indexing.
Deciding which attributes to index depends on your configuration and which LDAP server you are using.
See <a class="reference external" href="https://www.openldap.org/doc/admin24/tuning.html#Indexes">The openLDAP tuning guide</a> for openLDAP, and <a class="reference external" href="https://technet.microsoft.com/en-us/library/aa995762(v=exchg.65).aspx">How to Index an Attribute in Active Directory</a> for Active Directory.</p>
</div>
<div class="section" id="use-precise-base-dns">
<h3>Use precise base DNs<a class="headerlink" href="#use-precise-base-dns" title="Permalink to this headline">¶</a></h3>
<p>The more precise your base DN, the faster LDAP can search because it has fewer branches to search.</p>
</div>
<div class="section" id="use-precise-filters">
<h3>Use precise filters<a class="headerlink" href="#use-precise-filters" title="Permalink to this headline">¶</a></h3>
<p>Use good filters to further define the scope of LDAP searches, and to intelligently direct your server where to search, rather than forcing it to perform needlessly-general searches.</p>
</div>
</div>
<div class="section" id="owncloud-ldap-internals">
<h2>ownCloud LDAP Internals<a class="headerlink" href="#owncloud-ldap-internals" title="Permalink to this headline">¶</a></h2>
<p>Some parts of how the LDAP backend works are described here.</p>
<div class="section" id="user-and-group-mapping">
<h3>User and Group Mapping<a class="headerlink" href="#user-and-group-mapping" title="Permalink to this headline">¶</a></h3>
<p>In ownCloud the user or group name is used to have all relevant information in
the database assigned.
To work reliably a permanent internal user name and group name is created and mapped to the LDAP DN and UUID.
If the DN changes in LDAP it will be detected, and there will be no conflicts.</p>
<p>Those mappings are done in the database table <code class="docutils literal notranslate"><span class="pre">ldap_user_mapping</span></code> and <code class="docutils literal notranslate"><span class="pre">ldap_group_mapping</span></code>.
The user name is also used for the user’s folder (except if something else is specified in <em>User Home Folder Naming Rule</em>), which contains files and meta data.</p>
<p>As of ownCloud 5 the internal user name and a visible display name are separated.
This is not the case for group names, yet, i.e., a group name cannot be altered.</p>
<p>That means that your LDAP configuration should be good and ready before putting it into production.
The mapping tables are filled early, but as long as you are testing, you can empty the tables any time.
Do not do this in production.</p>
</div>
<div class="section" id="handling-with-backup-server">
<h3>Handling with Backup Server<a class="headerlink" href="#handling-with-backup-server" title="Permalink to this headline">¶</a></h3>
<p>When ownCloud is not able to contact the main LDAP server, ownCloud assumes it is offline and will not try to connect again for the time specified in” <strong>Cache Time-To-Live</strong>”.
If you have a backup server configured ownCloud will connect to it instead.
When you have scheduled downtime, check  “<strong>Disable Main Server</strong>”  to avoid unnecessary connection attempts.</p>
</div>
</div>
</div>


            
<ul class="prevnext-title list-unstyled list-inline">
  <li class="prev">
    <a href="user_auth_ftp_smb_imap.html" title="Previous Chapter: User Authentication with IMAP, SMB, and FTP"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; User Authenti...</span>
    </a>
  </li>
  <li class="next">
    <a href="user_provisioning_api.html" title="Next Chapter: User Provisioning API"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">User Provisioning API &raquo;</span>
    </a>
  </li>
</ul>
					</div>
				</div>
			</div>
  </main>
  </div>
</div>
<div class="container">
<div class="row">
    <div class="col-lg-12 footer-social-icons">
      <p class="text-center"><a target="_blank" href="https://plus.google.com/107072838776436530705/about"><img width=50 src="../../_static/img/social/googleplus.svg" title="Follow us on Google Plus!" alt="Follow us on Google Plus!"></img></a>
      <a target="_blank" style="margin: 0 7px 0 14px;" href="https://www.facebook.com/ownClouders"><img width=50 src="../../_static/img/social/facebook.svg" title="Like our facebook page!" alt="Like our facebook page!"></img></a>
      <a target="_blank" style="margin: 0 14px 0 7px;" href="https://twitter.com/ownClouders"><img width=50 src="../../_static/img/social/twitter.svg" title="Subscribe to our twitter channel!" alt="Subscribe to our twitter channel!"></img></a>
      <a target="_blank" href="https://owncloud.org/blogfeed"><img class="img-circle" width=50 src="../../_static/img/social/rss.svg" title="Subscribe to our news feed!" alt="Subscribe to our news feed!"></img></a>
      <a target="_blank" href="http://visitor.r20.constantcontact.com/d.jsp?llr=ixens9uab&amp;p=oi&amp;m=1121878184680&amp;sit=mf4qye7jb&amp;f=cc4cd13f-acdf-45d3-b132-75252542c37d"><img class="img-circle" width=50 src="../../_static/img/social/mail.svg"  title="Subscribe to our newsletter!" alt="Subscribe to our newsletter!"></img></a></p>
    </div>
    <div class="text-center">
      All documentation licensed under the <a href="https://creativecommons.org/licenses/by/3.0/us/">Creative Commons Attribution 3.0 Unported license</a>.
    </div>
</div>
</div>
<footer class="content-info" role="contentinfo">
<div class="container">
   <div class="row">
     <div class="col-sm-2 col-sm-offset-1">
        <div class="footer-nav">
          <h4>About ownCloud</h4>
          <ul id="menu-about" class="menu">
            <li class="menu-contact"><a href="https://owncloud.org/contact/">People</a></li>
            <li class="menu-history"><a href="https://owncloud.org/history/">History</a></li>
            <li class="menu-events"><a href="https://owncloud.org/events/">Events</a></li>
            <li class="menu-press"><a href="https://owncloud.org/press">Press</a></li>
            <li class="menu-privacy"><a href="https://owncloud.org/privacy/">Privacy policy</a></li>
          </ul>
        </div>
     </div>
     <div class="col-sm-2 col-sm-offset-2">
        <div class="footer-nav">
          <h4>Resources</h4>
          <ul id="menu-support-and-documentation" class="menu">
            <li class="menu-faq"><a href="https://owncloud.org/faq/">FAQ</a></li>
            <li class="menu-support"><a href="https://owncloud.org/support/">Support</a></li>
            <li class="menu-admin-manual"><a href="https://doc.owncloud.org">Documentation</a></li>
            <li class="menu-security"><a href="https://owncloud.org/security/">Security</a></li>
            <li class="menu-store"><a href="http://www.cafepress.com/owncloudshop">ownCloud Store</a></li>
          </ul>
        </div>
     </div>
     <div class="col-sm-2 col-sm-offset-2">
        <div class="footer-nav">
          <h4>Interact</h4>
          <ul id="menu-interact" class="menu">
            <li class="menu-irc-channel"><a href="https://webchat.freenode.net/?channels=owncloud">IRC Channel</a></li>
            <li class="menu-mailing-list"><a href="https://mailman.owncloud.org/mailman/listinfo/">Mailing List</a></li>
            <li class="menu-forums"><a href="https://forum.owncloud.org/">Forums</a></li>
            <li class="menu-bug-tracker"><a href="https://owncloud.org/contribute">Get involved</a></li>
            <li class="menu-promote"><a href="https://owncloud.org/promote/">Discuss ownCloud with others</a></li>

          </ul>
        </div>
     </div>
   </div>
   <div class="row">
      <div class="col-lg-12 footer-text">
        <p>
              &copy; Copyright 2013-2018, The ownCloud developers.<br/>
        </p>
      </div>
    </div>
  </div>
</footer>
  </body>
</html>