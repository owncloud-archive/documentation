
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Memory Caching &#8212; ownCloud 10.0.7 Server Administration Manual 10.0.7 documentation</title>
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/responsive.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Background Jobs" href="background_jobs_configuration.html" />
    <link rel="prev" title="Virus Scanner Support" href="antivirus_configuration.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://piwik.owncloud.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '4']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->

  </head><body>
  

<noscript><p><img src="https://piwik.owncloud.com/piwik.php?idsite=4&rec=1" style="border:0" alt=""></p></noscript>
<div class="header_con">
<div class="container">
<h1 id="site-title"><a href="http://doc.owncloud.com" title="ownCloud" rel="home">ownCloud</a></h1>

<form class="headersearch" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

<div class="follow">
<p><a class="visible" href="https://owncloud.com" title="ownCloud">Back to owncloud.com</a>|<span class="visible">Follow us:</span></p>
<a class="twitter" href="https://twitter.com/owncloud" target="_blank">Twitter</a>
<a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a>
<a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a>
</div>

</div>
</div>

<div id="main">
<div class="container">
  <div class="content">

    </div>
    
			<div class="row">
				<div class="span3">
					<div class="sidebar">
						<div class="box sidenavi">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>

<li><a href="../../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new_admin.html">What’s New in ownCloud 10.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../database/index.html">Database Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../files/index.html">File Sharing and Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ldap/ldap_proxy_cache_server_setup.html">How To Install and Configure an LDAP Proxy-Cache Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mimetypes/index.html">Mimetypes Management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Server Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="security_setup_warnings.html">Warnings on Admin Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="import_ssl_cert.html">Importing System-wide and Personal SSL Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="occ_command.html">Using the occ Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="activity_configuration.html">Configuring the Activity App</a></li>
<li class="toctree-l3"><a class="reference internal" href="antivirus_configuration.html">Virus Scanner Support</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Memory Caching</a></li>
<li class="toctree-l3"><a class="reference internal" href="background_jobs_configuration.html">Background Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_sample_php_parameters.html">Config.php Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="email_configuration.html">Email Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="excluded_blacklisted_files.html">Excluding Directories and Blacklisting Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="external_sites.html">Linking External Sites</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom_client_repos.html">Custom Client Download Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="knowledgebase_configuration.html">Knowledge Base Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="language_configuration.html">Language Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging_configuration.html">Logging Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="harden_server.html">Hardening and Security Guidance</a></li>
<li class="toctree-l3"><a class="reference internal" href="security/password-policy.html">Password Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="reverse_proxy_configuration.html">Reverse Proxy Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="thirdparty_php_configuration.html">Using Third Party PHP Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="automatic_configuration.html">Automatic Configuration Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="oc_server_tuning.html">ownCloud Server Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_php_less_urls.html">Enable index.php-less URLs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/index.html">User Management</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appliance/index.html">The ownCloud X Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

								</ul>
							</div>
						</div>
					</div>
				</div>
        

				<div class="span9">
					<div class="page-content">
						
  <div class="section" id="memory-caching">
<h1>Memory Caching<a class="headerlink" href="#memory-caching" title="Permalink to this headline">¶</a></h1>
<p>You can significantly improve ownCloud server performance by using memory caching.
This is the process of storing frequently-requested objects in-memory for faster retrieval later.
There are two types of memory caching available:</p>
<p><strong>A PHP opcode Cache (OPcache):</strong> An opcode cache stores compiled PHP scripts so they don’t need to be re-compiled every time they are called. These compiled PHP scripts are stored in-memory, on the server on which they’re compiled.</p>
<p><strong>A Data Cache:</strong> A data cache stores copies of <em>data</em>, <em>templates</em>, and other types of <em>information-based files</em>.
Depending on the cache implementation, it can be either <em>local</em>, or specific, to one server, or <em>distributed</em> across multiple servers.
This cache type is ideal when you have a scale-out installation.</p>
<div class="section" id="supported-caching-backends">
<h2>Supported Caching Backends<a class="headerlink" href="#supported-caching-backends" title="Permalink to this headline">¶</a></h2>
<p>The caching backends supported by ownCloud are:</p>
<ul class="simple">
<li><a class="reference internal" href="#apcu-label"><span class="std std-ref">APCu</span></a>: This is a local cache for systems running PHP 5.6 and up. APCu 4.0.6 and up is required. Alternatively you can use <cite>the Zend OPCache</cite>. However, <strong>it is not a data cache</strong>, only an opcode cache.</li>
<li><a class="reference internal" href="#redis-label"><span class="std std-ref">Redis</span></a>: This is a distributed cache for multi-server ownCloud installations. Version 2.2.6 or higher of the PHP Redis extension is required.</li>
<li><a class="reference internal" href="#memcached-label"><span class="std std-ref">Memcached</span></a>: This is a distributed cache for multi-server ownCloud installations.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may use <em>both</em> a local and a distributed cache.
The recommended ownCloud caches are APCu and Redis.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you do not install and enable a local memory cache you will see a warning on your ownCloud admin page.
If you enable only a distributed cache in your <code class="docutils literal notranslate"><span class="pre">config.php</span></code> (<code class="docutils literal notranslate"><span class="pre">memcache.distributed</span></code>) and not a local cache (<code class="docutils literal notranslate"><span class="pre">memcache.local</span></code>) you will still see the cache warning.</p>
</div>
<div class="section" id="cache-directory-location">
<h3>Cache Directory Location<a class="headerlink" href="#cache-directory-location" title="Permalink to this headline">¶</a></h3>
<p>The cache directory defaults to <code class="docutils literal notranslate"><span class="pre">data/$user/cache</span></code> where <code class="docutils literal notranslate"><span class="pre">$user</span></code> is the current user.
You may use the <code class="docutils literal notranslate"><span class="pre">'cache_path'</span></code> directive in <code class="docutils literal notranslate"><span class="pre">config.php</span></code> (See <a class="reference internal" href="config_sample_php_parameters.html"><span class="doc">Config.php Parameters</span></a>) to select a different location.</p>
</div>
</div>
<div class="section" id="cache-types">
<h2>Cache Types<a class="headerlink" href="#cache-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="apcu">
<span id="apcu-label"></span><h3>APCu<a class="headerlink" href="#apcu" title="Permalink to this headline">¶</a></h3>
<p>PHP 5.6 and up include the Zend OPcache in core, and on most Linux distributions it is enabled by default.
However, it <em>does not</em> bundle a data cache.
Given that, we recommend that you use APCu instead. APCu is a data cache <em>and</em> is available in most Linux distributions.</p>
<div class="section" id="installing-apcu">
<h4>Installing APCu<a class="headerlink" href="#installing-apcu" title="Permalink to this headline">¶</a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> On RedHat/CentOS/Fedora systems running PHP <span class="m">5</span>.6
<span class="go">yum install rh-php56-php-devel</span>
<span class="go">pecl install apcu</span>

<span class="gp">#</span> On RedHat/CentOS/Fedora systems running PHP <span class="m">7</span>.0
<span class="go">yum install rh-php70-php-devel</span>
<span class="go">pecl install apcu</span>

<span class="gp">#</span> On Debian/Ubuntu/Mint systems
<span class="go">apt-get install php-apcu</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>On Ubuntu 14.04 LTS, the APCu version is 4.0.2.
This is too old to use with ownCloud, which requires ownCloud 4.0.6+.
You can install 4.0.7 from Ubuntu backports with the following command:</p>
<div class="last highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">apt-get install php5-apcu/trusty-backports</span>
</pre></div>
</div>
</div>
<p>After APCu’s installed, enable the extension by creating a configuration file for it, using the following commands.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cat &lt;&lt; EOF &gt; /etc/opt/rh/rh-php70/php.d/20-apcu.ini</span>
<span class="go">; APCu php extension</span>
<span class="go">extension=apcu.so</span>
<span class="go">EOF</span>
</pre></div>
</div>
<p>With that done, assuming that you don’t encounter any errors, restart Apache and the extension is ready to use.</p>
</div>
</div>
<div class="section" id="redis">
<span id="redis-label"></span><h3>Redis<a class="headerlink" href="#redis" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://redis.io/">Redis</a> is an excellent modern memory cache to use for both distributed caching and as a local cache for <a class="reference internal" href="../files/files_locking_transactional.html"><span class="doc">Transactional File Locking</span></a>, because it guarantees that cached objects are available for as long as they are needed.</p>
<p>The Redis PHP module must be at least version 2.2.6 or higher.
If you are running a Linux distribution that does not package the supported versions of this module — or does not package Redis at all — see <a class="reference internal" href="#install-redis-label"><span class="std std-ref">Installing Redis on other distributions</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Debian Jessie users, please see this <a class="reference external" href="https://github.com/owncloud/core/issues/20675#issuecomment-159202901">GitHub discussion</a> if you have problems with LDAP authentication when using Redis.</p>
</div>
<div class="section" id="installing-redis-on-debian-based-distributions">
<h4>Installing Redis on Debian-based Distributions<a class="headerlink" href="#installing-redis-on-debian-based-distributions" title="Permalink to this headline">¶</a></h4>
<p>On Debian/Ubuntu/Mint run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">apt-get install redis-server php5-redis</span>
</pre></div>
</div>
<p>The installer will automatically launch Redis and configure it to launch at startup.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you’re running ownCloud on Ubuntu 14.04, which does not package the required version of <code class="docutils literal notranslate"><span class="pre">php5-redis</span></code>, then work through <a class="reference external" href="https://www.techandme.se/how-to-configure-redis-cache-in-ubuntu-14-04-with-owncloud/">this guide on Tech and Me</a> to see how to install and configure it.</p>
</div>
</div>
<div class="section" id="installing-redis-on-redhat-centos-and-fedora">
<h4>Installing Redis on RedHat, CentOS, and Fedora<a class="headerlink" href="#installing-redis-on-redhat-centos-and-fedora" title="Permalink to this headline">¶</a></h4>
<p>On RedHat, CentOS, and Fedora run the following commands to install Redis:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">yum install rh-php70-php-devel rh-redis32-redis</span>
<span class="go">pecl install redis</span>
</pre></div>
</div>
<p>Unlike on Debian-based distributions, Redis will not start automatically on <em>RedHat</em>, <em>Centos</em>, and <em>Fedora</em>.
Given that, you must use your service manager to both start Redis, and to launch it at boot time as a daemon.
To do so, run the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">systemctl start rh-redis32-redis</span>
<span class="go">systemctl enable rh-redis32-redis</span>
</pre></div>
</div>
<p>You can verify that the Redis daemon is running using either of the following two commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ps ax | grep redis</span>
<span class="go">netstat -tlnp | grep redis</span>
</pre></div>
</div>
<p>When it’s running, enable the Redis extension by creating a configuration file for it, using the following commands.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cat &lt;&lt; EOF &gt; /etc/opt/rh/rh-php70/php.d/20-redis.ini</span>
<span class="go">; Redis php extension</span>
<span class="go">extension=redis.so</span>
<span class="go">EOF</span>
</pre></div>
</div>
<p>After that, assuming that you don’t encounter any errors, restart Apache and the extension is ready to use.</p>
</div>
<div class="section" id="additional-notes-for-redis-vs-apcu-on-memory-caching">
<h4>Additional notes for Redis vs. APCu on Memory Caching<a class="headerlink" href="#additional-notes-for-redis-vs-apcu-on-memory-caching" title="Permalink to this headline">¶</a></h4>
<p>APCu is faster at local caching than Redis.
If you have enough memory, use APCu for memory caching and Redis for file locking.
If you are low on memory, use Redis for both.</p>
</div>
<div class="section" id="installing-redis-on-other-distributions">
<span id="install-redis-label"></span><h4>Installing Redis on other distributions<a class="headerlink" href="#installing-redis-on-other-distributions" title="Permalink to this headline">¶</a></h4>
<p>These instructions are adaptable for any distribution that does not package the supported version, or that does not package Redis at all, such as SUSE Linux Enterprise Server and RedHat Enterprise Linux.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference external" href="https://pecl.php.net/package/redis">Redis PHP module</a> must be at least version 2.2.6.</p>
</div>
<div class="section" id="on-debian-mint-ubuntu">
<h5>On Debian/Mint/Ubuntu<a class="headerlink" href="#on-debian-mint-ubuntu" title="Permalink to this headline">¶</a></h5>
<p>Use <code class="docutils literal notranslate"><span class="pre">apt-cache</span></code> to see the available <code class="docutils literal notranslate"><span class="pre">php5-redis</span></code> version, or the version of your installed package:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">apt-cache policy php5-redis</span>
</pre></div>
</div>
</div>
<div class="section" id="on-centos-and-fedora">
<h5>On CentOS and Fedora<a class="headerlink" href="#on-centos-and-fedora" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">yum</span></code> command shows available and installed version information:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">yum search php-pecl-redis</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="clearing-the-redis-cache">
<h4>Clearing the Redis Cache<a class="headerlink" href="#clearing-the-redis-cache" title="Permalink to this headline">¶</a></h4>
<p>The Redis cache can be flushed from the command-line using <a class="reference external" href="https://redis.io/topics/rediscli">the redis-cli tool</a>, as in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">redis</span><span class="o">-</span><span class="n">cli</span>
<span class="n">SELECT</span> <span class="o">&lt;</span><span class="n">dbIndex</span><span class="o">&gt;</span>
<span class="n">FLUSHDB</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;dbIndex&gt;</span></code> is the number of Redis database where the cache is stored.
It is zero by default at ownCloud.
To check what yours is currently set to, check the <code class="docutils literal notranslate"><span class="pre">dbindex</span></code> value in <code class="docutils literal notranslate"><span class="pre">config/config.php</span></code>.
Here’s an example of what to look for:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;redis&#39;: {</span>
<span class="x">    &#39;host&#39; =&gt; &#39;localhost&#39;,  // Can also be a unix domain socket =&gt; &#39;/tmp/redis.sock&#39;</span>
<span class="x">    &#39;port&#39; =&gt; 6379,</span>
<span class="x">    &#39;timeout&#39; =&gt; 0,</span>
<span class="x">    &#39;password&#39; =&gt; &#39;&#39;,       // Optional, if not defined no password will be used.</span>
<span class="x">    &#39;dbindex&#39; =&gt; 0          // Optional, if undefined SELECT will not run and will</span>
<span class="x">                            // use Redis Server&#39;s default DB Index.</span>
<span class="x">},</span>
</pre></div>
</div>
<div class="section" id="further-reading">
<h5>Further Reading<a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference external" href="https://redis.io/commands/select">https://redis.io/commands/select</a></li>
<li><a class="reference external" href="https://redis.io/commands/flushdb">https://redis.io/commands/flushdb</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="memcached">
<span id="memcached-label"></span><h3>Memcached<a class="headerlink" href="#memcached" title="Permalink to this headline">¶</a></h3>
<p>Memcached is a reliable old-timer for shared caching on distributed servers.
It performs well with ownCloud with one exception: it is not suitable to use with <a class="reference internal" href="../files/files_locking_transactional.html"><span class="doc">Transactional File Locking</span></a>.
This is because it does not store locks, and data can disappear from the cache at any time.
Given that, Redis is the best memory cache to use.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Be sure to install the <strong>memcached</strong> PHP module, and not <em>memcache</em>, as
in the following examples. ownCloud supports only the <strong>memcached</strong> PHP
module.</p>
</div>
<div class="section" id="installing-memcached">
<h4>Installing Memcached<a class="headerlink" href="#installing-memcached" title="Permalink to this headline">¶</a></h4>
<div class="section" id="on-debian-ubuntu-mint">
<h5>On Debian/Ubuntu/Mint<a class="headerlink" href="#on-debian-ubuntu-mint" title="Permalink to this headline">¶</a></h5>
<p>On Debian/Ubuntu/Mint run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">apt-get install memcached php5-memcached</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The installer will automatically start <code class="docutils literal notranslate"><span class="pre">memcached</span></code> and configure it to launch at startup.</p>
</div>
</div>
<div class="section" id="on-redhat-centos-fedora">
<h5>On RedHat/CentOS/Fedora<a class="headerlink" href="#on-redhat-centos-fedora" title="Permalink to this headline">¶</a></h5>
<p>On RedHat/CentOS/Fedora run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">yum install memcached php-pecl-memcache</span>
</pre></div>
</div>
<p>It will not start Memcached automatically after the installation or on subsequent reboots as a daemon, so you must do so yourself .
To do so, run the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">systemctl start memcached</span>
<span class="go">systemctl enable memcached</span>
</pre></div>
</div>
<p>You can verify that the Memcached daemon is running using one of the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ps ax | grep memcached</span>
<span class="go">netstat -tlnp | grep memcached</span>
</pre></div>
</div>
<p>With the extension installed, you now need to configure it, by creating a configuration file for it.
You can do so using the command below, substituting <code class="docutils literal notranslate"><span class="pre">FILE_PATH</span></code> with one from the list below the command.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cat &lt;&lt; EOF &gt; FILE_PATH</span>
<span class="go">; Memcached PHP extension</span>
<span class="go">extension=memcached.so</span>
<span class="go">EOF</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuration-file-paths">
<h4>Configuration File Paths<a class="headerlink" href="#configuration-file-paths" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">PHP Version</th>
<th class="head">Filename</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.6</td>
<td><code class="docutils literal notranslate"><span class="pre">/etc/opt/rh/rh-php56/php.d/25-memcached.ini</span></code></td>
</tr>
<tr class="row-odd"><td>7.0</td>
<td><code class="docutils literal notranslate"><span class="pre">/etc/opt/rh/rh-php70/php.d/25-memcached.ini</span></code></td>
</tr>
</tbody>
</table>
<p>After that, assuming that you don’t encounter any errors:</p>
<ol class="arabic simple">
<li>Restart your Web server</li>
<li>Add the appropriate entries to <code class="docutils literal notranslate"><span class="pre">config.php</span></code> (which you can find an example of below)</li>
<li>Refresh your ownCloud admin page</li>
</ol>
</div>
<div class="section" id="clearing-the-memcached-cache">
<h4>Clearing the Memcached Cache<a class="headerlink" href="#clearing-the-memcached-cache" title="Permalink to this headline">¶</a></h4>
<p>The Memcached cache can be flushed from the command-line using a range of common Linux/UNIX tools, including netcat and telnet.
The following example uses telnet to login, run <a class="reference external" href="https://github.com/memcached/memcached/wiki/Commands#flushall">the flush_all command</a>, and logout:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">telnet</span> <span class="n">localhost</span> <span class="mi">11211</span>
<span class="n">flush_all</span>
<span class="n">quit</span>
</pre></div>
</div>
<p>For more information see:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/memcached/memcached/wiki/Commands#flushall">https://github.com/memcached/memcached/wiki/Commands#flushall</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="configuring-memory-caching">
<h2>Configuring Memory Caching<a class="headerlink" href="#configuring-memory-caching" title="Permalink to this headline">¶</a></h2>
<p>Memory caches must be explicitly configured in ownCloud by:</p>
<ol class="arabic simple">
<li>Installing and enabling your desired cache (whether that be the PHP extension and/or the caching server).</li>
<li>Adding the appropriate entry to ownCloud’s <code class="docutils literal notranslate"><span class="pre">config.php</span></code>.</li>
</ol>
<p>See <a class="reference internal" href="config_sample_php_parameters.html"><span class="doc">Config.php Parameters</span></a> for an overview of all possible config parameters.
After installing and enabling your chosen memory cache, verify that it is active by running <a class="reference internal" href="../../issues/general_troubleshooting.html#label-phpinfo"><span class="std std-ref">PHP Version and Information</span></a>.</p>
<div class="section" id="apcu-configuration">
<h3>APCu Configuration<a class="headerlink" href="#apcu-configuration" title="Permalink to this headline">¶</a></h3>
<p>To use APCu, add this line to <code class="docutils literal notranslate"><span class="pre">config.php</span></code>:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;memcache.local&#39; =&gt; &#39;\OC\Memcache\APCu&#39;,</span>
</pre></div>
</div>
<p>With that done, refresh your ownCloud admin page, and the cache warning should disappear.</p>
</div>
<div class="section" id="redis-configuration">
<h3>Redis Configuration<a class="headerlink" href="#redis-configuration" title="Permalink to this headline">¶</a></h3>
<p>This example <code class="docutils literal notranslate"><span class="pre">config.php</span></code> configuration uses Redis for the local server cache:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x"> &#39;memcache.local&#39; =&gt; &#39;\OC\Memcache\Redis&#39;,</span>
<span class="x"> &#39;redis&#39; =&gt; [</span>
<span class="x">     &#39;host&#39; =&gt; &#39;localhost&#39;,</span>
<span class="x">     &#39;port&#39; =&gt; 6379,</span>
<span class="x"> ],</span>
<span class="x">&#39;memcache.locking&#39; =&gt; &#39;\OC\Memcache\Redis&#39;, // Add this for best performance</span>
</pre></div>
</div>
<p>If you want to connect to Redis configured to listen on an Unix socket, which is recommended if Redis is running on the same system as ownCloud, use this example configuration:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;memcache.local&#39; =&gt; &#39;\OC\Memcache\Redis&#39;,</span>
<span class="x">&#39;redis&#39; =&gt; [</span>
<span class="x">     &#39;host&#39; =&gt; &#39;/var/run/redis/redis.sock&#39;,</span>
<span class="x">     &#39;port&#39; =&gt; 0,</span>
<span class="x">],</span>
</pre></div>
</div>
<p>Redis is very configurable; consult <a class="reference external" href="http://redis.io/documentation">the Redis documentation</a> to learn more.</p>
</div>
<div class="section" id="memcached-configuration">
<span id="transactional-file-locking-label"></span><h3>Memcached Configuration<a class="headerlink" href="#memcached-configuration" title="Permalink to this headline">¶</a></h3>
<p>This example uses APCu for the local cache, Memcached as the distributed memory cache, and lists all the servers in the shared cache pool with their port numbers:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;memcache.local&#39; =&gt; &#39;\OC\Memcache\APCu&#39;,</span>
<span class="x">&#39;memcache.distributed&#39; =&gt; &#39;\OC\Memcache\Memcached&#39;,</span>
<span class="x">&#39;memcached_servers&#39; =&gt; [</span>
<span class="x">     [&#39;localhost&#39;, 11211],</span>
<span class="x">     [&#39;server1.example.com&#39;, 11211],</span>
<span class="x">     [&#39;server2.example.com&#39;, 11211],</span>
<span class="x"> ],</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration-recommendations-based-on-type-of-deployment">
<h3>Configuration Recommendations Based on Type of Deployment<a class="headerlink" href="#configuration-recommendations-based-on-type-of-deployment" title="Permalink to this headline">¶</a></h3>
<div class="section" id="small-private-home-server">
<h4>Small/Private Home Server<a class="headerlink" href="#small-private-home-server" title="Permalink to this headline">¶</a></h4>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">// Only use APCu</span>
<span class="x">&#39;memcache.local&#39; =&gt; &#39;\OC\Memcache\APCu&#39;,</span>
</pre></div>
</div>
</div>
<div class="section" id="small-organization-single-server-setup">
<h4>Small Organization, Single-server Setup<a class="headerlink" href="#small-organization-single-server-setup" title="Permalink to this headline">¶</a></h4>
<p>Use APCu for local caching, Redis for file locking</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;memcache.local&#39; =&gt; &#39;\OC\Memcache\APCu&#39;,</span>
<span class="x">&#39;memcache.locking&#39; =&gt; &#39;\OC\Memcache\Redis&#39;,</span>
<span class="x">&#39;redis&#39; =&gt; [</span>
<span class="x">    &#39;host&#39; =&gt; &#39;localhost&#39;,</span>
<span class="x">    &#39;port&#39; =&gt; 6379,</span>
<span class="x">],</span>
</pre></div>
</div>
</div>
<div class="section" id="large-organization-clustered-setup">
<h4>Large Organization, Clustered Setup<a class="headerlink" href="#large-organization-clustered-setup" title="Permalink to this headline">¶</a></h4>
<p>Use Redis for everything except a local memory cache.
Use the server’s IP address or hostname so that it is accessible to other hosts:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;memcache.distributed&#39; =&gt; &#39;\OC\Memcache\Redis&#39;,</span>
<span class="x">&#39;memcache.locking&#39; =&gt; &#39;\OC\Memcache\Redis&#39;,</span>
<span class="x">&#39;memcache.local&#39; =&gt; &#39;\OC\Memcache\APCu&#39;,</span>
<span class="x">&#39;redis&#39; =&gt; [</span>
<span class="x">    &#39;host&#39; =&gt; &#39;server1&#39;,      // hostname example</span>
<span class="x">    &#39;host&#39; =&gt; &#39;12.34.56.78&#39;,  // IP address example</span>
<span class="x">    &#39;port&#39; =&gt; 6379,</span>
<span class="x">],</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuring-transactional-file-locking">
<span id="configuring-transactional-file-locking-label"></span><h3>Configuring Transactional File Locking<a class="headerlink" href="#configuring-transactional-file-locking" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../files/files_locking_transactional.html"><span class="doc">Transactional File Locking</span></a> prevents simultaneous file saving.
To use it, you have to enable it in <code class="docutils literal notranslate"><span class="pre">config.php</span></code> as in the following example, which uses Redis as the cache backend:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;filelocking.enabled&#39; =&gt; true,</span>
<span class="x">&#39;memcache.locking&#39; =&gt; &#39;\OC\Memcache\Redis&#39;,</span>
<span class="x">&#39;redis&#39; =&gt; [</span>
<span class="x">     &#39;host&#39; =&gt; &#39;localhost&#39;,</span>
<span class="x">     &#39;port&#39; =&gt; 6379,</span>
<span class="x">     &#39;timeout&#39; =&gt; 0.0,</span>
<span class="x">     &#39;password&#39; =&gt; &#39;&#39;, // Optional, if not defined no password will be used.</span>
<span class="x"> ],</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For enhanced security it is recommended to configure Redis to require a password.
See <a class="reference external" href="http://redis.io/topics/security">http://redis.io/topics/security</a> for more information.</p>
</div>
</div>
</div>
<div class="section" id="caching-exceptions">
<h2>Caching Exceptions<a class="headerlink" href="#caching-exceptions" title="Permalink to this headline">¶</a></h2>
<p>If ownCloud is configured to use either Memcached or Redis as a memory cache, please be aware that you may encounter issues with functionality.
When these occur, it is usually a result of PHP being incorrectly configured, or the relevant PHP extension not being available.</p>
<p>In the table below, you can see all of the known reasons for reduced or broken functionality related to caching.</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Setup/Configuration</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>If file locking is enabled, but the locking
cache class is missing, then an exception
will appear in the web UI</td>
<td>The application will not be usable</td>
</tr>
<tr class="row-odd"><td>If file locking is enabled and the locking
cache is configured, but the PHP module
missing.</td>
<td>There will be a white page/exception in web UI. It
will be a full page issue, and the application will not be
usable</td>
</tr>
<tr class="row-even"><td>All enabled, but the Redis server is not
running</td>
<td>The application will be usable. But any file operation will
return a <strong>“500 Redis went away”</strong> exception</td>
</tr>
<tr class="row-odd"><td>If Memcache is configured for “local” and
“distributed”, but the class is missing</td>
<td>There will be a white page and an exception written to the logs,
This is because autoloading needs the missing class. So there is
no way to show a page</td>
</tr>
</tbody>
</table>
</div>
</div>


					</div>
				</div>
			</div>

  </div>
</div>
</div>
<footer class="footer">
  <div class="container">
  <div class="footer_navi">

  <div class="menu-footer-navigation-container">
  	<ul id="menu-footer-navigation" class="menu">
  		<li><a href="https://owncloud.com">Home</a></li>
  		<li><a href="https://owncloud.com/about">About ownCloud</a></li>
  		<li><a href="https://owncloud.com/resources">Resources</a></li>
  		<li><a href="https://owncloud.com/become-partner">Become a Partner</a></li>
  		<li><a href="https://owncloud.org">Community</a></li>
  		<li><a href="https://owncloud.com/blog">Blog</a></li>
  		<li><a href="https://owncloud.com/jobs">Jobs</a></li>
  		<li><a href="https://owncloud.com/contact">Contact</a></li>
  	</ul>
  </div>

  <div class="follow_f">
  	<ul>
  		<li><a class="twitter" href="https://twitter.com/ownloud" target="_blank">Twitter</a></li>
  		<li><a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a></li>
  		<li><a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a></li>
  	</ul>
  </div>

  <p class="copyright">© ownCloud 2011-2015</p>

  </div>
  </div>
</footer>
  </body>
</html>