
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Excluding Directories and Blacklisting Files &#8212; ownCloud 10.0.7 Server Administration Manual 10.0.7 documentation</title>
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/responsive.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Linking External Sites" href="external_sites.html" />
    <link rel="prev" title="Email Configuration" href="email_configuration.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://piwik.owncloud.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '4']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->

  </head><body>
  

<noscript><p><img src="https://piwik.owncloud.com/piwik.php?idsite=4&rec=1" style="border:0" alt=""></p></noscript>
<div class="header_con">
<div class="container">
<h1 id="site-title"><a href="http://doc.owncloud.com" title="ownCloud" rel="home">ownCloud</a></h1>

<form class="headersearch" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

<div class="follow">
<p><a class="visible" href="https://owncloud.com" title="ownCloud">Back to owncloud.com</a>|<span class="visible">Follow us:</span></p>
<a class="twitter" href="https://twitter.com/owncloud" target="_blank">Twitter</a>
<a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a>
<a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a>
</div>

</div>
</div>

<div id="main">
<div class="container">
  <div class="content">

    </div>
    
			<div class="row">
				<div class="span3">
					<div class="sidebar">
						<div class="box sidenavi">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>

<li><a href="../../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new_admin.html">What’s New in ownCloud 10.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../database/index.html">Database Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../files/index.html">File Sharing and Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ldap/ldap_proxy_cache_server_setup.html">How To Install and Configure an LDAP Proxy-Cache Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mimetypes/index.html">Mimetypes Management</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Server Configuration</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="security_setup_warnings.html">Warnings on Admin Page</a></li>
<li class="toctree-l3"><a class="reference internal" href="import_ssl_cert.html">Importing System-wide and Personal SSL Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="occ_command.html">Using the occ Command</a></li>
<li class="toctree-l3"><a class="reference internal" href="activity_configuration.html">Configuring the Activity App</a></li>
<li class="toctree-l3"><a class="reference internal" href="antivirus_configuration.html">Virus Scanner Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="caching_configuration.html">Memory Caching</a></li>
<li class="toctree-l3"><a class="reference internal" href="background_jobs_configuration.html">Background Jobs</a></li>
<li class="toctree-l3"><a class="reference internal" href="config_sample_php_parameters.html">Config.php Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="email_configuration.html">Email Configuration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Excluding Directories and Blacklisting Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="external_sites.html">Linking External Sites</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom_client_repos.html">Custom Client Download Repositories</a></li>
<li class="toctree-l3"><a class="reference internal" href="knowledgebase_configuration.html">Knowledge Base Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="language_configuration.html">Language Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="logging_configuration.html">Logging Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="harden_server.html">Hardening and Security Guidance</a></li>
<li class="toctree-l3"><a class="reference internal" href="security/password-policy.html">Password Policy</a></li>
<li class="toctree-l3"><a class="reference internal" href="reverse_proxy_configuration.html">Reverse Proxy Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="thirdparty_php_configuration.html">Using Third Party PHP Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="automatic_configuration.html">Automatic Configuration Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="oc_server_tuning.html">ownCloud Server Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_php_less_urls.html">Enable index.php-less URLs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../user/index.html">User Management</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appliance/index.html">The ownCloud X Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

								</ul>
							</div>
						</div>
					</div>
				</div>
        

				<div class="span9">
					<div class="page-content">
						
  <div class="section" id="excluding-directories-and-blacklisting-files">
<h1>Excluding Directories and Blacklisting Files<a class="headerlink" href="#excluding-directories-and-blacklisting-files" title="Permalink to this headline">¶</a></h1>
<div class="section" id="definitions-of-terms">
<h2>Definitions of terms<a class="headerlink" href="#definitions-of-terms" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name"><strong>Blacklisted</strong>:</th><td class="field-body">Files that may harm the ownCloud environment like a foreign <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> file. Blacklisting prevents anyone from uploading blacklisted files to the ownCloud server.</td>
</tr>
<tr class="field-even field"><th class="field-name"><strong>Excluded</strong>:</th><td class="field-body">Existing directories on your ownCloud server, including external storage mounts, that are excluded from being processed by ownCloud. In effect they are invisible to ownCloud.</td>
</tr>
</tbody>
</table>
<p>Both types are defined in <code class="docutils literal notranslate"><span class="pre">config.php</span></code>. Blacklisted files and excluded directories are not scanned by ownCloud, not viewed, not synced, and cannot be created, renamed, deleted, or accessed via direct path input from a file explorer. Even when a filepath is entered manually via a file explorer, the path cannot be accessed.</p>
<p>For example configurations please see <code class="docutils literal notranslate"><span class="pre">owncloud/config/config.sample.php</span></code>.</p>
</div>
<div class="section" id="impact-on-system-performance">
<h2>Impact on System Performance<a class="headerlink" href="#impact-on-system-performance" title="Permalink to this headline">¶</a></h2>
<p>If you have a filesystem mounted with 200,000 files and directories and 15 snapshots in rotation, you would now scan and process 200,000 elements plus 200,000 x 15 = 3,000,000 elements additionally. These additional 3,000,000 elements, 15 times more than the original quantity, would also be available for viewing and synchronisation. Because this is a big and unnecessary overhead, most times confusing to clients, further processing can be eliminated by using excluded directories.</p>
</div>
<div class="section" id="blacklisted-files">
<h2>Blacklisted Files<a class="headerlink" href="#blacklisted-files" title="Permalink to this headline">¶</a></h2>
<p>By default, ownCloud blacklists the file <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> to secure the running instance, which is important when using Apache as webserver. A foreign <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> file could overwrite rules defined by ownCloud. There is no explicit need to enter the file name <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> as parameter to the <code class="docutils literal notranslate"><span class="pre">blacklisted_files</span></code> array in <code class="docutils literal notranslate"><span class="pre">config.php</span></code>, but you can add more blacklisted file names if necessary.</p>
</div>
<div class="section" id="excluded-directories">
<h2>Excluded Directories<a class="headerlink" href="#excluded-directories" title="Permalink to this headline">¶</a></h2>
<p><strong>Reason for excluding directories:</strong></p>
<ol class="arabic simple">
<li>Enterprise storage systems, or special filesystems like ZFS and BtrFS are capable of snapshots. These snapshots are directories and keep point-in-time views of the data.</li>
<li>Snapshot directories are read-only.</li>
<li>There is no common naming for these directories, and most likely will never be. NetApp uses <code class="docutils literal notranslate"><span class="pre">.snapshot</span></code> and <code class="docutils literal notranslate"><span class="pre">~snapshot</span></code>, EMC eg <code class="docutils literal notranslate"><span class="pre">.ckpt</span></code>, HDS eg <code class="docutils literal notranslate"><span class="pre">.latest</span></code> and <code class="docutils literal notranslate"><span class="pre">~latest</span></code>, the ZFS filesystem uses <code class="docutils literal notranslate"><span class="pre">.zfs</span></code> and so on.</li>
<li>Viewing and scanning of these directories does not make any sense as these directories are used to ease backup, restores, and cloning</li>
<li>Directories which are part of the mounted filesystem, but must not be accessible via ownCloud.</li>
</ol>
<p><strong>Example:</strong></p>
<p>If you have a snapshot-capable storage or filesystem where snapshots are enabled and presented to clients, each directory will contain a “special” visible directory named e.g. <code class="docutils literal notranslate"><span class="pre">.snapshot</span></code>. Depending on the system, you may find underneath a list of snapshots taken and in the next lower level the complete set of files and directories which were present when the snapshot was created. In most systems, this mechanism is true in all directory levels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/.</span><span class="n">snapshot</span>
     <span class="o">/</span><span class="n">nightly</span><span class="o">.</span><span class="mi">0</span>
             <span class="o">/</span><span class="n">home</span>
             <span class="o">/</span><span class="n">dat</span>
             <span class="o">/</span><span class="n">pictures</span>
             <span class="n">file_1</span>
             <span class="n">file_2</span>
     <span class="o">/</span><span class="n">nightly</span><span class="o">.</span><span class="mi">1</span>
             <span class="o">/</span><span class="n">home</span>
             <span class="o">/</span><span class="n">dat</span>
             <span class="o">/</span><span class="n">pictures</span>
             <span class="n">file_1</span>
             <span class="n">file_2</span>
     <span class="o">/</span><span class="n">nightly</span><span class="o">.</span><span class="mi">2</span>
             <span class="o">/</span><span class="n">home</span>
             <span class="o">/</span><span class="n">dat</span>
             <span class="o">/</span><span class="n">pictures</span>
             <span class="n">file_1</span>
             <span class="n">file_2</span>
     <span class="o">...</span>
<span class="o">/</span><span class="n">home</span>
<span class="o">/</span><span class="n">dat</span>
<span class="o">/</span><span class="n">pictures</span>
<span class="n">file_1</span>
<span class="n">file_2</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Example <code class="docutils literal notranslate"><span class="pre">excluded_directories</span></code> entries in <code class="docutils literal notranslate"><span class="pre">config.php</span></code> look like this:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;excluded_directories&#39; =&gt; [</span>
<span class="x">    &#39;.snapshot&#39;,</span>
<span class="x">    &#39;~snapshot&#39;,</span>
<span class="x">    &#39;dir1&#39;,</span>
<span class="x">    &#39;dir2&#39;,</span>
<span class="x">],</span>
</pre></div>
</div>
<p>Note that these are not pathnames, but directory names without any slashes. Excluding <code class="docutils literal notranslate"><span class="pre">dir1</span></code> excludes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">dir1</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">stuff</span><span class="o">/</span><span class="n">dir1</span>
</pre></div>
</div>
<p>But not:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/.</span><span class="n">dir1</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">stuff</span><span class="o">/</span><span class="n">mydir1</span>
</pre></div>
</div>
<p>Example <code class="docutils literal notranslate"><span class="pre">blacklisted_files</span></code> entries in <code class="docutils literal notranslate"><span class="pre">config.php</span></code> look like this:</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">&#39;blacklisted_files&#39; =&gt; [</span>
<span class="x">    &#39;hosts&#39;,</span>
<span class="x">    &#39;evil_script.sh&#39;,</span>
<span class="x">],</span>
</pre></div>
</div>
</div>
</div>


					</div>
				</div>
			</div>

  </div>
</div>
</div>
<footer class="footer">
  <div class="container">
  <div class="footer_navi">

  <div class="menu-footer-navigation-container">
  	<ul id="menu-footer-navigation" class="menu">
  		<li><a href="https://owncloud.com">Home</a></li>
  		<li><a href="https://owncloud.com/about">About ownCloud</a></li>
  		<li><a href="https://owncloud.com/resources">Resources</a></li>
  		<li><a href="https://owncloud.com/become-partner">Become a Partner</a></li>
  		<li><a href="https://owncloud.org">Community</a></li>
  		<li><a href="https://owncloud.com/blog">Blog</a></li>
  		<li><a href="https://owncloud.com/jobs">Jobs</a></li>
  		<li><a href="https://owncloud.com/contact">Contact</a></li>
  	</ul>
  </div>

  <div class="follow_f">
  	<ul>
  		<li><a class="twitter" href="https://twitter.com/ownloud" target="_blank">Twitter</a></li>
  		<li><a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a></li>
  		<li><a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a></li>
  	</ul>
  </div>

  <p class="copyright">© ownCloud 2011-2015</p>

  </div>
  </div>
</footer>
  </body>
</html>