
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Uploading big files &gt; 512MB &#8212; ownCloud 10.0.7 Server Administration Manual 10.0.7 documentation</title>
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/responsive.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Providing Default Files" href="default_files_configuration.html" />
    <link rel="prev" title="Configuring Federation Sharing" href="federated_cloud_sharing_configuration.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://piwik.owncloud.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '4']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->

  </head><body>
  

<noscript><p><img src="https://piwik.owncloud.com/piwik.php?idsite=4&rec=1" style="border:0" alt=""></p></noscript>
<div class="header_con">
<div class="container">
<h1 id="site-title"><a href="http://doc.owncloud.com" title="ownCloud" rel="home">ownCloud</a></h1>

<form class="headersearch" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

<div class="follow">
<p><a class="visible" href="https://owncloud.com" title="ownCloud">Back to owncloud.com</a>|<span class="visible">Follow us:</span></p>
<a class="twitter" href="https://twitter.com/owncloud" target="_blank">Twitter</a>
<a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a>
<a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a>
</div>

</div>
</div>

<div id="main">
<div class="container">
  <div class="content">

    </div>
    
			<div class="row">
				<div class="span3">
					<div class="sidebar">
						<div class="box sidenavi">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>

<li><a href="../../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new_admin.html">What’s New in ownCloud 10.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../database/index.html">Database Configuration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">File Sharing and Management</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="file_sharing_configuration.html">File Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="federated_cloud_sharing_configuration.html">Configuring Federation Sharing</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Uploading big files &gt; 512MB</a></li>
<li class="toctree-l3"><a class="reference internal" href="default_files_configuration.html">Providing Default Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="external_storage_configuration_gui.html">Configuring External Storage (GUI)</a></li>
<li class="toctree-l3"><a class="reference internal" href="external_storage_configuration.html">Configuring External Storage (Configuration File)</a></li>
<li class="toctree-l3"><a class="reference internal" href="external_storage/auth_mechanisms.html">External Storage Authentication mechanisms</a></li>
<li class="toctree-l3"><a class="reference internal" href="encryption_configuration.html">Encryption Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="files_locking_transactional.html">Transactional File Locking</a></li>
<li class="toctree-l3"><a class="reference internal" href="previews_configuration.html">Previews Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="file_versioning.html">Controlling File Versions and Aging</a></li>
<li class="toctree-l3"><a class="reference internal" href="trashbin_options.html">Managing the Trashbin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ldap/ldap_proxy_cache_server_setup.html">How To Install and Configure an LDAP Proxy-Cache Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mimetypes/index.html">Mimetypes Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../server/index.html">Server Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/index.html">User Management</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../appliance/index.html">The ownCloud X Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

								</ul>
							</div>
						</div>
					</div>
				</div>
        

				<div class="span9">
					<div class="page-content">
						
  <div class="section" id="uploading-big-files-512mb">
<h1>Uploading big files &gt; 512MB<a class="headerlink" href="#uploading-big-files-512mb" title="Permalink to this headline">¶</a></h1>
<p>The default maximum file size for uploads, in ownCloud, is 512MB.
You can increase this limit up to the maximum file size which your filesystem, operating system, or other software allows, for example:</p>
<ul class="simple">
<li>&lt; 2GB on a 32Bit OS-architecture</li>
<li>&lt; 2GB with IE6 - IE8</li>
<li>&lt; 4GB with IE9 - IE11</li>
</ul>
<p>64-bit filesystems have much higher limits.
Please consult the documentation for your filesystem.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The ownCloud sync client itself however is able to upload files of any size, as it uploads files by transmitting them in small chunks. But, it can never exceed the maximum file size limits of the remote host.</p>
</div>
<div class="section" id="system-configuration">
<h2>System Configuration<a class="headerlink" href="#system-configuration" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Make sure that the latest version of PHP (at least 5.6) is installed</li>
<li>Disable user quotas, which makes them unlimited</li>
<li>Your temp file or partition has to be big enough to hold multiple
parallel uploads from multiple users; e.g. if the max upload size is 10GB and
the average number of users uploading at the same time is 100: temp space has
to hold at least 10x100 GB</li>
</ul>
</div>
<div class="section" id="configuring-your-web-server">
<h2>Configuring Your Web server<a class="headerlink" href="#configuring-your-web-server" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ownCloud comes with its own <code class="docutils literal notranslate"><span class="pre">owncloud/.htaccess</span></code> file. Because <code class="docutils literal notranslate"><span class="pre">php-fpm</span></code>
can’t read PHP settings in <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> these settings must be set in the
<code class="docutils literal notranslate"><span class="pre">owncloud/.user.ini</span></code> file.</p>
</div>
<p>Set the following two parameters inside the corresponding php.ini file (see the
<strong>Loaded Configuration File</strong> section of <a class="reference internal" href="../../issues/general_troubleshooting.html#label-phpinfo"><span class="std std-ref">PHP Version and Information</span></a> to find your
relevant php.ini files)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">php_value</span> <span class="n">upload_max_filesize</span> <span class="o">=</span> <span class="mi">16</span><span class="n">G</span>
<span class="n">php_value</span> <span class="n">post_max_size</span> <span class="o">=</span> <span class="mi">16</span><span class="n">G</span>
</pre></div>
</div>
<p>Adjust these values for your needs. If you see PHP timeouts in your logfiles,
increase the timeout values, which are in seconds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">php_value</span> <span class="n">max_input_time</span> <span class="mi">3600</span>
<span class="n">php_value</span> <span class="n">max_execution_time</span> <span class="mi">3600</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://httpd.apache.org/docs/current/mod/mod_reqtimeout.html">mod_reqtimeout</a>
Apache module could also stop large uploads from completing. If you’re using this
module and getting failed uploads of large files either disable it in your Apache
config or raise the configured <code class="docutils literal notranslate"><span class="pre">RequestReadTimeout</span></code> timeouts.</p>
<p>There are also several other configuration options in your Web server config which
could prevent the upload of larger files. Please see the manual of your Web server
for how to configure those values correctly:</p>
<div class="section" id="apache">
<h3>Apache<a class="headerlink" href="#apache" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://httpd.apache.org/docs/current/en/mod/core.html#limitrequestbody">LimitRequestBody</a></li>
<li><a class="reference external" href="https://httpd.apache.org/docs/current/mod/mod_ssl.html#sslrenegbuffersize">SSLRenegBufferSize</a></li>
</ul>
</div>
<div class="section" id="apache-with-mod-fcgid">
<h3>Apache with mod_fcgid<a class="headerlink" href="#apache-with-mod-fcgid" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html#fcgidmaxrequestinmem">FcgidMaxRequestInMem</a></li>
<li><a class="reference external" href="https://httpd.apache.org/mod_fcgid/mod/mod_fcgid.html#fcgidmaxrequestlen">FcgidMaxRequestLen</a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you are using Apache/2.4 with mod_fcgid, as of February/March 2016,
<code class="docutils literal notranslate"><span class="pre">FcgidMaxRequestInMem</span></code> still needs to be significantly increased from its default value
to avoid the occurence of segmentation faults when uploading big files. This is not a regular
setting but serves as a workaround for <a class="reference external" href="https://bz.apache.org/bugzilla/show_bug.cgi?id=51747">Apache with mod_fcgid bug #51747</a>.</p>
<p class="last">Setting <code class="docutils literal notranslate"><span class="pre">FcgidMaxRequestInMem</span></code> significantly higher than normal may no longer be
necessary, once bug #51747 is fixed.</p>
</div>
</div>
<div class="section" id="nginx">
<h3>NGINX<a class="headerlink" href="#nginx" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size">client_max_body_size</a></li>
<li><a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_fastcgi_module.html#fastcgi_read_timeout">fastcgi_read_timeout</a></li>
<li><a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_core_module.html#client_body_temp_path">client_body_temp_path</a></li>
</ul>
<p>Since NGINX 1.7.11 a new config option <a class="reference external" href="https://nginx.org/en/docs/http/ngx_http_fastcgi_module.html#fastcgi_request_buffering">fastcgi_request_buffering</a>
is availabe. Setting this option to <code class="docutils literal notranslate"><span class="pre">fastcgi_request_buffering</span> <span class="pre">off;</span></code> in your NGINX config
might help with timeouts during the upload. Furthermore it helps if you’re running out of
disc space on the <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> partition of your system.</p>
<p>For more info how to configure NGINX to raise the upload limits see also <a class="reference external" href="https://github.com/owncloud/documentation/wiki/Uploading-files-up-to-16GB#configuring-nginx">this</a>
wiki entry.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure that <code class="docutils literal notranslate"><span class="pre">client_body_temp_path</span></code> points to a partition with
adequate space for your upload file size, and on the same partition as
the <code class="docutils literal notranslate"><span class="pre">upload_tmp_dir</span></code> or <code class="docutils literal notranslate"><span class="pre">tempdirectory</span></code> (see below). For optimal
performance, place these on a separate hard drive that is dedicated to
swap and temp storage.</p>
</div>
<p>If your site is behind a NGINX frontend (for example a loadbalancer):</p>
<p>By default, downloads will be limited to 1GB due to <code class="docutils literal notranslate"><span class="pre">proxy_buffering</span></code> and <code class="docutils literal notranslate"><span class="pre">proxy_max_temp_file_size</span></code> on the frontend.</p>
<ul class="simple">
<li>If you can access the frontend’s configuration, disable <a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_buffering">proxy_buffering</a> or increase <a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_max_temp_file_size">proxy_max_temp_file_size</a> from the default 1GB.</li>
<li>If you do not have access to the frontend, set the <a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_buffering">X-Accel-Buffering</a> header to <code class="docutils literal notranslate"><span class="pre">add_header</span> <span class="pre">X-Accel-Buffering</span> <span class="pre">no;</span></code> on your backend server.</li>
</ul>
</div>
</div>
<div class="section" id="configuring-php">
<h2>Configuring PHP<a class="headerlink" href="#configuring-php" title="Permalink to this headline">¶</a></h2>
<p>If you don’t want to use the ownCloud <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> or <code class="docutils literal notranslate"><span class="pre">.user.ini</span></code> file, you may
configure PHP instead. Make sure to comment out any lines <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code>
pertaining to upload size, if you entered any.</p>
<p>If you are running ownCloud on a 32-bit system, any <code class="docutils literal notranslate"><span class="pre">open_basedir</span></code> directive
in your <code class="docutils literal notranslate"><span class="pre">php.ini</span></code> file needs to be commented out.</p>
<p>Set the following two parameters inside <code class="docutils literal notranslate"><span class="pre">php.ini</span></code>, using your own desired
file size values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">upload_max_filesize</span> <span class="o">=</span> <span class="mi">16</span><span class="n">G</span>
<span class="n">post_max_size</span> <span class="o">=</span> <span class="mi">16</span><span class="n">G</span>
</pre></div>
</div>
<p>Tell PHP which temp file you want it to use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">upload_tmp_dir</span> <span class="o">=</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">big_temp_file</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Output Buffering</strong> must be turned off in <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> or <code class="docutils literal notranslate"><span class="pre">.user.ini</span></code> or <code class="docutils literal notranslate"><span class="pre">php.ini</span></code>, or PHP
will return memory-related errors:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">output_buffering</span> <span class="pre">=</span> <span class="pre">0</span></code></li>
</ul>
</div>
<div class="section" id="configuring-owncloud">
<h2>Configuring ownCloud<a class="headerlink" href="#configuring-owncloud" title="Permalink to this headline">¶</a></h2>
<p>As an alternative to the <code class="docutils literal notranslate"><span class="pre">upload_tmp_dir</span></code> of PHP (e.g., if you don’t have access to your
<code class="docutils literal notranslate"><span class="pre">php.ini</span></code>) you can also configure a temporary location for uploaded files by using the
<code class="docutils literal notranslate"><span class="pre">tempdirectory</span></code> setting in your <code class="docutils literal notranslate"><span class="pre">config.php</span></code> (See <a class="reference internal" href="../server/config_sample_php_parameters.html"><span class="doc">Config.php Parameters</span></a>).</p>
<p>If you have configured the <code class="docutils literal notranslate"><span class="pre">session_lifetime</span></code> setting in your <code class="docutils literal notranslate"><span class="pre">config.php</span></code>
(See <a class="reference internal" href="../server/config_sample_php_parameters.html"><span class="doc">Config.php Parameters</span></a>) file then
make sure it is not too
low. This setting needs to be configured to at least the time (in seconds) that
the longest upload will take. If unsure remove this completely from your
configuration to reset it to the default shown in the <code class="docutils literal notranslate"><span class="pre">config.sample.php</span></code>.</p>
<div class="section" id="configuring-upload-limits-within-the-gui">
<h3>Configuring upload limits within the GUI<a class="headerlink" href="#configuring-upload-limits-within-the-gui" title="Permalink to this headline">¶</a></h3>
<p>If all prerequisites described in this documentation are in place an admin can change the
upload limits on demand by using the <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">handling</span></code> input box within the administrative
backend of ownCloud.</p>
<div class="figure">
<img alt="../../_images/admin_filehandling-1.png" src="../../_images/admin_filehandling-1.png" />
</div>
<p>Depending on your environment you might get an insufficient permissions message shown for
this input box.</p>
<div class="figure">
<img alt="../../_images/admin_filehandling-2.png" src="../../_images/admin_filehandling-2.png" />
</div>
<p>To be able to use this input box you need to make sure that:</p>
<ul class="simple">
<li>Your Web server is be able to use the <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> file shipped by ownCloud (Apache only)</li>
<li>The user your Web server is running as has write permissions to the files <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> and <code class="docutils literal notranslate"><span class="pre">.user.ini</span></code></li>
</ul>
<p><a class="reference internal" href="../../installation/source_installation.html#strong-perms-label"><span class="std std-ref">Set Strong Directory Permissions</span></a> might prevent write access to these files. As an admin you need
to decide between the ability to use the input box and a more secure ownCloud installation
where you need to manually modify the upload limits in the <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> and <code class="docutils literal notranslate"><span class="pre">.user.ini</span></code>
files described above.</p>
</div>
</div>
<div class="section" id="general-upload-issues">
<h2>General upload issues<a class="headerlink" href="#general-upload-issues" title="Permalink to this headline">¶</a></h2>
<p>Various environmental factors could cause a restriction of the upload size. Examples are:</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">LVE</span> <span class="pre">Manager</span></code> of <code class="docutils literal notranslate"><span class="pre">CloudLinux</span></code> which sets a <code class="docutils literal notranslate"><span class="pre">I/O</span> <span class="pre">limit</span></code></li>
<li>Some services like <code class="docutils literal notranslate"><span class="pre">Cloudflare</span></code> are also known to cause uploading issues</li>
<li>Upload limits enforced by proxies used by your clients</li>
<li>Other webserver modules like described in <a class="reference internal" href="../../issues/general_troubleshooting.html"><span class="doc">General Troubleshooting</span></a></li>
</ul>
</div>
</div>


					</div>
				</div>
			</div>

  </div>
</div>
</div>
<footer class="footer">
  <div class="container">
  <div class="footer_navi">

  <div class="menu-footer-navigation-container">
  	<ul id="menu-footer-navigation" class="menu">
  		<li><a href="https://owncloud.com">Home</a></li>
  		<li><a href="https://owncloud.com/about">About ownCloud</a></li>
  		<li><a href="https://owncloud.com/resources">Resources</a></li>
  		<li><a href="https://owncloud.com/become-partner">Become a Partner</a></li>
  		<li><a href="https://owncloud.org">Community</a></li>
  		<li><a href="https://owncloud.com/blog">Blog</a></li>
  		<li><a href="https://owncloud.com/jobs">Jobs</a></li>
  		<li><a href="https://owncloud.com/contact">Contact</a></li>
  	</ul>
  </div>

  <div class="follow_f">
  	<ul>
  		<li><a class="twitter" href="https://twitter.com/ownloud" target="_blank">Twitter</a></li>
  		<li><a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a></li>
  		<li><a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a></li>
  	</ul>
  </div>

  <p class="copyright">© ownCloud 2011-2015</p>

  </div>
  </div>
</footer>
  </body>
</html>