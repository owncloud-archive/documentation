
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>The Installation Wizard &#8212; ownCloud 10.0.7 Server Administration Manual 10.0.7 documentation</title>
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/responsive.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bootstrap.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installing with Docker" href="docker/index.html" />
    <link rel="prev" title="Linux Package Manager Installation" href="linux_installation.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://piwik.owncloud.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '4']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->

  </head><body>
  

<noscript><p><img src="https://piwik.owncloud.com/piwik.php?idsite=4&rec=1" style="border:0" alt=""></p></noscript>
<div class="header_con">
<div class="container">
<h1 id="site-title"><a href="http://doc.owncloud.com" title="ownCloud" rel="home">ownCloud</a></h1>

<form class="headersearch" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

<div class="follow">
<p><a class="visible" href="https://owncloud.com" title="ownCloud">Back to owncloud.com</a>|<span class="visible">Follow us:</span></p>
<a class="twitter" href="https://twitter.com/owncloud" target="_blank">Twitter</a>
<a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a>
<a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a>
</div>

</div>
</div>

<div id="main">
<div class="container">
  <div class="content">

    </div>
    
			<div class="row">
				<div class="span3">
					<div class="sidebar">
						<div class="box sidenavi">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>

<li><a href="../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new_admin.html">What’s New in ownCloud 10.0.7</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Installation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="system_requirements.html">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment_recommendations.html">Deployment Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment_considerations.html">Deployment Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="source_installation.html">Manual Installation on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="linux_installation.html">Linux Package Manager Installation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">The Installation Wizard</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="#in-depth-guide">In-Depth Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="#post-installation-steps">Post-Installation Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="docker/index.html">Installing with Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_line_installation.html">Command Line Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration_notes_and_tips.html">Configuration Notes &amp; Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="changing_the_web_route.html">Changing Your ownCloud URL</a></li>
<li class="toctree-l2"><a class="reference internal" href="apps_management_installation.html">Installing and Managing Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="apps_supported.html">Supported Apps in ownCloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="selinux_configuration.html">SELinux Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="nginx_configuration.html">NGINX Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="letsencrypt/index.html">Using Let’s Encrypt SSL Certificates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../enterprise/index.html">Enterprise Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appliance/index.html">The ownCloud X Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/index.html">FAQ</a></li>
</ul>

								</ul>
							</div>
						</div>
					</div>
				</div>
        

				<div class="span9">
					<div class="page-content">
						
  <div class="section" id="the-installation-wizard">
<h1>The Installation Wizard<a class="headerlink" href="#the-installation-wizard" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you are planning to use the installation wizard, we <strong>strongly</strong> encourage you to protect it, through some form of <a class="reference external" href="https://wiki.apache.org/httpd/PasswordBasicAuth">password authentication</a>, or <a class="reference external" href="https://httpd.apache.org/docs/2.4/howto/access.html">access control</a>. If the installer is left unprotected when exposed to the public internet, there is the possibility that a malicious actor could finish the installation and block you out — or worse. So please ensure that only you — or someone from your organization — can access the web installer.</p>
</div>
<div class="section" id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>When the ownCloud prerequisites are fulfilled and all ownCloud files are installed, the last step to completing the installation is running the Installation Wizard.
This involves just three steps:</p>
<ol class="arabic simple">
<li>Point your web browser to <code class="docutils literal notranslate"><span class="pre">http://localhost/owncloud</span></code></li>
<li>Enter your desired administrator’s username and password.</li>
<li>Click “Finish Setup”.</li>
</ol>
<div class="figure">
<a class="reference internal image-reference" href="../_images/install-wizard-a.png"><img alt="screenshot of the installation wizard" src="../_images/install-wizard-a.png" style="width: 250.5px; height: 350.25px;" /></a>
</div>
<p>You’re now finished and can start using your new ownCloud server.
Of course, there is much more that you <em>can</em> do to set up your ownCloud server for best performance and security.
In the following sections we will cover important installation and post-installation steps.
Note that you must follow the instructions in <a class="reference internal" href="source_installation.html#strong-perms-label"><span class="std std-ref">Setting Strong Permissions</span></a> in order to use the <a class="reference internal" href="../configuration/server/occ_command.html"><span class="doc">occ Command</span></a>.</p>
</div>
<div class="section" id="in-depth-guide">
<h2>In-Depth Guide<a class="headerlink" href="#in-depth-guide" title="Permalink to this headline">¶</a></h2>
<p>This section provides a more detailed guide to the installation wizard.
Specifically, it is broken down into three steps:</p>
<ol class="arabic simple">
<li><a class="reference internal" href="#data-directory-location-label"><span class="std std-ref">Data Directory Location</span></a></li>
<li><a class="reference internal" href="#database-choice-label"><span class="std std-ref">Database Choices</span></a></li>
<li><a class="reference internal" href="#post-installation-steps-label"><span class="std std-ref">Post-Installation Steps</span></a></li>
</ol>
<div class="section" id="data-directory-location">
<span id="data-directory-location-label"></span><h3>Data Directory Location<a class="headerlink" href="#data-directory-location" title="Permalink to this headline">¶</a></h3>
<p>Click “Storage and Database” to expose additional installation configuration
options for your ownCloud data directory and database.</p>
<div class="figure">
<a class="reference internal image-reference" href="../_images/install-wizard-a1.png"><img alt="installation wizard with all options exposed" src="../_images/install-wizard-a1.png" style="width: 280.5px; height: 418.5px;" /></a>
</div>
<p>You should locate your ownCloud data directory outside of your Web root if you are using an HTTP server other than Apache, or you may wish to store your ownCloud data in a different location for other reasons (e.g. on a storage server).</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Please know that ownCloud’s data directory <strong>must be exclusive to ownCloud</strong> and not be modified manually by any other process or user.</p>
</div>
<p>It is best to configure your data directory location at installation, as it is difficult to move after installation. You may put it anywhere; in this example is it located in <code class="docutils literal notranslate"><span class="pre">/var/oc_data</span></code>.
This directory must already exist, and must be owned by your HTTP user (see <a class="reference internal" href="source_installation.html#strong-perms-label"><span class="std std-ref">Set Strong Directory Permissions</span></a>).</p>
</div>
<div class="section" id="database-choices">
<span id="database-choice-label"></span><h3>Database Choices<a class="headerlink" href="#database-choices" title="Permalink to this headline">¶</a></h3>
<p>When installing ownCloud Server &amp; ownCloud Enterprise editions the administrator may choose one of 4 supported database products.
These are:</p>
<ul class="simple">
<li><cite>SQLite</cite></li>
<li><cite>MYSQL/MariaDB</cite></li>
<li><cite>PostgreSQL</cite></li>
<li><cite>Oracle 11g</cite> (Enterprise-edition only)</li>
</ul>
<div class="section" id="sqlite">
<h4>SQLite<a class="headerlink" href="#sqlite" title="Permalink to this headline">¶</a></h4>
<p>SQLite is the default database for ownCloud Server — but is not supported by the ownCloud Enterprise edition.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SQLite is only good for testing and lightweight single user setups.
It has no client synchronization support, so other devices will not be able to synchronize with the data stored in an ownCloud SQLite database.</p>
</div>
<p>SQLite will be installed by the ownCloud package and all the necessary dependencies will be satisfied.
If you used the package manager to install ownCloud, you may “Finish Setup” with no additional steps to configure ownCloud using the SQLite database for limited use.</p>
</div>
<div class="section" id="mysql-mariadb">
<h4>MYSQL/MariaDB<a class="headerlink" href="#mysql-mariadb" title="Permalink to this headline">¶</a></h4>
<p>MariaDB is the ownCloud recommended database.
It may be used with either ownCloud Server or ownCloud Enterprise editions.
To install the recommended MySQL/MariaDB database, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">mariadb</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p>If you have an administrator login that has permissions to create and modify databases, you may choose “Storage &amp; Database”.
Then, enter your database administrator username and password, and the name you want for your ownCloud database.
Alternatively, you can use these steps to create a temporary database administrator account.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">mysql</span> <span class="o">--</span><span class="n">user</span><span class="o">=</span><span class="n">root</span> <span class="n">mysql</span>
<span class="n">CREATE</span> <span class="n">USER</span> <span class="s1">&#39;dbadmin&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">IDENTIFIED</span> <span class="n">BY</span> <span class="s1">&#39;Apassword&#39;</span><span class="p">;</span>
<span class="n">GRANT</span> <span class="n">ALL</span> <span class="n">PRIVILEGES</span> <span class="n">ON</span> <span class="o">*.*</span> <span class="n">TO</span> <span class="s1">&#39;dbadmin&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span> <span class="n">WITH</span> <span class="n">GRANT</span> <span class="n">OPTION</span><span class="p">;</span>
<span class="n">FLUSH</span> <span class="n">PRIVILEGES</span><span class="p">;</span>
<span class="n">exit</span>
</pre></div>
</div>
<p>For more detailed information, see <a class="reference internal" href="system_requirements.html"><span class="doc">MySQL/MariaDB</span></a>.</p>
</div>
<div class="section" id="postgresql">
<h4>PostgreSQL<a class="headerlink" href="#postgresql" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://www.postgresql.org">PostgreSQL</a> is also supported by ownCloud.
To install it, use the following command (or that of your preferred package manager):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">postgresql</span>
</pre></div>
</div>
<p>In order to allow ownCloud access to the database, create a known password for the default user, <code class="docutils literal notranslate"><span class="pre">postgres</span></code>, which was added when the database was installed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">i</span> <span class="o">-</span><span class="n">u</span> <span class="n">postgres</span> <span class="n">psql</span>
<span class="n">postgres</span><span class="o">=</span><span class="c1"># \password</span>
<span class="n">Enter</span> <span class="n">new</span> <span class="n">password</span><span class="p">:</span>
<span class="n">Enter</span> <span class="n">it</span> <span class="n">again</span><span class="p">:</span>
<span class="n">postgres</span><span class="o">=</span><span class="c1"># \q</span>
<span class="n">exit</span>
</pre></div>
</div>
</div>
<div class="section" id="oracle-11g">
<h4>Oracle 11g<a class="headerlink" href="#oracle-11g" title="Permalink to this headline">¶</a></h4>
<p>Oracle 11g is only supported for the ownCloud Enterprise edition.</p>
</div>
</div>
<div class="section" id="database-setup-by-owncloud">
<h3>Database Setup By ownCloud<a class="headerlink" href="#database-setup-by-owncloud" title="Permalink to this headline">¶</a></h3>
<p>Your database and PHP connectors must be installed before you run the Installation Wizard by clicking the “Finish setup” button.
After you enter your temporary or root administrator login for your database, the installer creates a special database user with privileges limited to the ownCloud database.</p>
<p>Following this, ownCloud needs only this special ownCloud database user and drops the temporary or root database login.
This new user is named from your ownCloud admin user, with an <code class="docutils literal notranslate"><span class="pre">oc_</span></code> prefix, and given a random password.
The ownCloud database user and password are written into <code class="docutils literal notranslate"><span class="pre">config.php</span></code>:</p>
<p>For MySQL/MariaDB:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;dbuser&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;oc_dbadmin&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbpassword&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;pX65Ty5DrHQkYPE5HRsDvyFHlZZHcm&#39;</span><span class="p">,</span>
</pre></div>
</div>
<p>For PostgreSQL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;dbuser&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;oc_postgres&#39;</span><span class="p">,</span>
<span class="s1">&#39;dbpassword&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;pX65Ty5DrHQkYPE5HRsDvyFHlZZHcm&#39;</span><span class="p">,</span>
</pre></div>
</div>
<p>Click Finish Setup, and you’re ready to start using your new ownCloud server.</p>
</div>
</div>
<div class="section" id="post-installation-steps">
<span id="post-installation-steps-label"></span><h2>Post-Installation Steps<a class="headerlink" href="#post-installation-steps" title="Permalink to this headline">¶</a></h2>
<p>Now we will look at some important post-installation steps.
For hardened security we recommend setting the permissions on your ownCloud directories as strictly as possible, and for proper server operations.
This should be done immediately after the initial installation and before running the setup.</p>
<p>Your HTTP user must own the <code class="docutils literal notranslate"><span class="pre">config/</span></code>, <code class="docutils literal notranslate"><span class="pre">data/</span></code>, <code class="docutils literal notranslate"><span class="pre">apps/</span></code> respectively the <code class="docutils literal notranslate"><span class="pre">apps-external/</span></code> directories so that you can configure ownCloud, create, modify and delete your data files, and install apps via the ownCloud Web interface.</p>
<p>You can find your HTTP user in your HTTP server configuration files, or you can use <a class="reference internal" href="../issues/general_troubleshooting.html#label-phpinfo"><span class="std std-ref">PHP Version and Information</span></a> (Look for the <strong>User/Group</strong> line).</p>
<ul class="simple">
<li>The HTTP user and group in Debian/Ubuntu is <code class="docutils literal notranslate"><span class="pre">www-data</span></code>.</li>
<li>The HTTP user and group in Fedora/CentOS is <code class="docutils literal notranslate"><span class="pre">apache</span></code>.</li>
<li>The HTTP user and group in Arch Linux is <code class="docutils literal notranslate"><span class="pre">http</span></code>.</li>
<li>The HTTP user in openSUSE is <code class="docutils literal notranslate"><span class="pre">wwwrun</span></code>, and the HTTP group is <code class="docutils literal notranslate"><span class="pre">www</span></code>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using an NFS mount for the data directory, do not change its
ownership from the default. The simple act of mounting the drive will set
proper permissions for ownCloud to write to the directory. Changing
ownership as above could result in some issues if the NFS mount is
lost.</p>
</div>
<p>The easy way to set the correct permissions is to copy and run the script, below.
The script sets proper permissions and ownership including the handling of necessary directories.
The script also prepares for an <code class="docutils literal notranslate"><span class="pre">apps-external</span></code> directory, for details see <code class="docutils literal notranslate"><span class="pre">config.sample.php</span></code>:</p>
<ul class="simple">
<li>Replace the <code class="docutils literal notranslate"><span class="pre">ocpath</span></code> variable with the path to your ownCloud directory.</li>
<li>Replace the <code class="docutils literal notranslate"><span class="pre">ocdata</span></code> variable with the path to your ownCloud data directory.</li>
<li>Replace the <code class="docutils literal notranslate"><span class="pre">apps_external</span></code> variable with the path to your ownCloud apps-external directory.</li>
</ul>
<p>In case use want to use links for the data and apps-external directory:</p>
<ul class="simple">
<li>Replace the <code class="docutils literal notranslate"><span class="pre">linkdata</span></code> variable with the path to your ownCloud linked data directory.</li>
<li>Replace the <code class="docutils literal notranslate"><span class="pre">linkapps-external</span></code> variable with the path to your ownCloud linked apps-external directory.</li>
</ul>
<p>Set the correct HTTP user and group according your needs:</p>
<ul class="simple">
<li>Replace the <code class="docutils literal notranslate"><span class="pre">htuser</span></code> and <code class="docutils literal notranslate"><span class="pre">htgroup</span></code> variables with your HTTP user and group.</li>
</ul>
<p>In case of upgrading using tar:</p>
<ul class="simple">
<li>Replace the <code class="docutils literal notranslate"><span class="pre">oldocpath</span></code> variable with the path to your old ownCloud directory.</li>
</ul>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">#!/bin/bash</span>

<span class="x">ocpath=&#39;/var/www/owncloud&#39;</span>
<span class="x">ocdata=&#39;/var/www/owncloud/data&#39;</span>
<span class="x">ocapps_external=&#39;/var/www/owncloud/apps-external&#39;</span>
<span class="x">oldocpath=&#39;/var/www/owncloud.old&#39;</span>
<span class="x">linkdata=&quot;/var/mylinks/data&quot;</span>
<span class="x">linkapps-external=&quot;/var/mylinks/apps-external&quot;</span>
<span class="x">htuser=&#39;www-data&#39;</span>
<span class="x">htgroup=&#39;www-data&#39;</span>
<span class="x">rootuser=&#39;root&#39;</span>

<span class="x"># Because the data directory can be huge or on external storage, an automatic chmod/chown can take a while.</span>
<span class="x"># Therefore this directory can be treated differently.</span>
<span class="x"># If you have already created an external data and apps-external directory which you want to link,</span>
<span class="x"># set the paths above accordingly. This script can link and set the proper rights and permissions</span>
<span class="x"># depending what you enter when running the script.</span>
<span class="x"># You have to run this script twice, one time to prepare installation and one time post installation</span>

<span class="x"># Example input</span>
<span class="x"># New install using mkdir:     n/n/n (create missing directories, setup permissions and ownership)</span>
<span class="x"># Upgrade using mkdir:         n/n/n (you move/replace data, apps-external and config.php manually, set setup permissions and ownership)</span>
<span class="x"># New install using links:     y/y/n (link existing directories, setup permissions and ownership)</span>
<span class="x"># Upgrade using links:         y/n/y (link existing directories, copy config.php, permissions and ownership are already ok)</span>
<span class="x"># Post installation/upgrade:   either n/n/n or y/y/n</span>
<span class="x"># Reset all perm &amp; own:        either n/n/n or y/y/n</span>

<span class="x">echo</span>
<span class="x">read -p &quot;Do you want to use ln instead of mkdir for creating directories (y/N)? &quot; -r -e answer</span>
<span class="x">if echo &quot;$answer&quot; | grep -iq &quot;^y&quot;; then</span>
<span class="x">  uselinks=&quot;y&quot;</span>
<span class="x">else</span>
<span class="x">  uselinks=&quot;n&quot;</span>
<span class="x">fi</span>

<span class="x">read -p &quot;Do you also want to chmod/chown these links (y/N)? &quot; -r -e answer</span>
<span class="x">if echo &quot;$answer&quot; | grep -iq &quot;^y&quot;; then</span>
<span class="x">  chmdir=&quot;y&quot;</span>
<span class="x">else</span>
<span class="x">  chmdir=&quot;n&quot;</span>
<span class="x">fi</span>

<span class="x">read -p &quot;If you upgrade, do you want to copy an existing config.php file (y/N)? &quot; -r -e answer</span>
<span class="x">if echo &quot;$answer&quot; | grep -iq &quot;^y&quot;; then</span>
<span class="x">  upgrdcfg=&quot;y&quot;</span>
<span class="x">else</span>
<span class="x">  upgrdcfg=&quot;n&quot;</span>
<span class="x">fi</span>

<span class="x">printf &quot;\nCreating or linking possible missing directories \n&quot;</span>
<span class="x">mkdir -p $ocpath/updater</span>
<span class="x"># check if directory creation is possible and create if ok</span>
<span class="x">if [ &quot;$uselinks&quot; = &quot;n&quot; ]; then</span>
<span class="x">  if [ -L ${ocdata} ]; then</span>
<span class="x">    echo &quot;Symlink for $ocdata found but mkdir requested. Exiting.&quot;</span>
<span class="x">    echo</span>
<span class="x">    exit</span>
<span class="x">  else</span>
<span class="x">    echo &quot;mkdir $ocdata&quot;</span>
<span class="x">    echo</span>
<span class="x">    mkdir -p $ocdata</span>
<span class="x">  fi</span>
<span class="x">  if [ -L ${ocapps_external} ]; then</span>
<span class="x">    echo &quot;Symlink for $ocapps_external found but mkdir requested. Exiting.&quot;</span>
<span class="x">    echo</span>
<span class="x">    exit</span>
<span class="x">  else</span>
<span class="x">    printf &quot;mkdir $ocapps_external \n&quot;</span>
<span class="x">    mkdir -p $ocapps_external</span>
<span class="x">  fi</span>
<span class="x">else</span>
<span class="x">  if [ -d ${ocdata} ]; then</span>
<span class="x">    echo &quot;Directory for $ocdata found but link requested. Exiting.&quot;</span>
<span class="x">    echo</span>
<span class="x">    exit</span>
<span class="x">  else</span>
<span class="x">    printf &quot;ln $ocdata \n&quot;</span>
<span class="x">    ln -sfn $linkdata $ocdata</span>
<span class="x">  fi</span>
<span class="x">  if [ -d ${ocapps_external} ]; then</span>
<span class="x">    echo &quot;Directory for $ocapps_external found but link requested. Exiting.&quot;</span>
<span class="x">    echo</span>
<span class="x">    exit</span>
<span class="x">  else</span>
<span class="x">    printf &quot;ln $ocapps_external \n&quot;</span>
<span class="x">    ln -sfn $linkapps-external $ocapps_external</span>
<span class="x">  fi</span>
<span class="x">fi</span>

<span class="x"># Copy if requested an existing config.php</span>
<span class="x">if [ &quot;$upgrdcfg&quot; = &quot;y&quot; ]; then</span>
<span class="x">  if [ -f ${oldocpath}/config/config.php ]; then</span>
<span class="x">    printf &quot;\nCopy existing config.php file \n&quot;</span>
<span class="x">    cp ${oldocpath}/config/config.php ${ocpath}/config/config.php</span>
<span class="x">  else</span>
<span class="x">    printf &quot;Skipping copy config.php, not found: ${oldocpath}/config/config.php \n&quot;</span>
<span class="x">  fi</span>
<span class="x">fi</span>

<span class="x">printf &quot;\nchmod files and directories excluding data and apps-external directory \n&quot;</span>
<span class="x">find -L ${ocpath} -path ${ocdata} -prune -o -path ${ocapps_external} -prune -o -type f -print0 | xargs -0 chmod 0640</span>
<span class="x">find -L ${ocpath} -path ${ocdata} -prune -o -path ${ocapps_external} -prune -o -type d -print0 | xargs -0 chmod 0750</span>

<span class="x"># no error messages on empty directories</span>
<span class="x">if [ &quot;$chmdir&quot; = &quot;n&quot; ] &amp;&amp; [ &quot;$uselinks&quot; = &quot;n&quot; ]; then</span>
<span class="x">  printf &quot;chmod data and apps-external directory (mkdir) \n&quot;</span>
<span class="x">  if [ -n &quot;$(ls -A $ocdata)&quot; ]; then</span>
<span class="x">    find ${ocdata}/ -type f -print0 | xargs -0 chmod 0640</span>
<span class="x">  fi</span>
<span class="x">  find ${ocdata}/ -type d -print0 | xargs -0 chmod 0750</span>
<span class="x">  if [ -n &quot;$(ls -A $ocapps_external)&quot; ]; then</span>
<span class="x">    find ${ocapps_external}/ -type f -print0 | xargs -0 chmod 0640</span>
<span class="x">  fi</span>
<span class="x">  find ${ocapps_external}/ -type d -print0 | xargs -0 chmod 0750</span>
<span class="x">fi</span>

<span class="x">if [ &quot;$chmdir&quot; = &quot;y&quot; ] &amp;&amp; [ &quot;$uselinks&quot; = &quot;y&quot; ]; then</span>
<span class="x">  printf &quot;chmod data and apps-external directory (linked) \n&quot;</span>
<span class="x">  if [ -n &quot;$(ls -A $ocdata)&quot; ]; then</span>
<span class="x">    find -L ${ocdata}/ -type f -print0 | xargs -0 chmod 0640</span>
<span class="x">  fi</span>
<span class="x">  find -L ${ocdata}/ -type d -print0 | xargs -0 chmod 0750</span>
<span class="x">  if [ -n &quot;$(ls -A $ocapps_external)&quot; ]; then</span>
<span class="x">    find -L ${ocapps_external}/ -type f -print0 | xargs -0 chmod 0640</span>
<span class="x">  fi</span>
<span class="x">  find -L ${ocapps_external}/ -type d -print0 | xargs -0 chmod 0750</span>
<span class="x">fi</span>

<span class="x">printf &quot;\nchown files and directories excluding data and apps-external directory \n&quot;</span>
<span class="x">find  -L $ocpath  -path ${ocdata} -prune -o -path ${ocapps_external} -prune -o -type d -print0 | xargs -0 chown ${rootuser}:${htgroup}</span>
<span class="x">find  -L $ocpath  -path ${ocdata} -prune -o -path ${ocapps_external} -prune -o -type f -print0 | xargs -0 chown ${rootuser}:${htgroup}</span>

<span class="x"># do only if the directories are present</span>
<span class="x">if [ -d ${ocpath}/apps/ ]; then</span>
<span class="x">  printf &quot;chown apps directory \n&quot;</span>
<span class="x">  chown -R ${htuser}:${htgroup} ${ocpath}/apps/</span>
<span class="x">fi</span>
<span class="x">if [ -d ${ocpath}/config/ ]; then</span>
<span class="x">  printf &quot;chown config directory \n&quot;</span>
<span class="x">  chown -R ${htuser}:${htgroup} ${ocpath}/config/</span>
<span class="x">fi</span>
<span class="x">if [ -d ${ocpath}/updater/ ]; then</span>
<span class="x">  printf &quot;chown updater directory \n&quot;</span>
<span class="x">  chown -R ${htuser}:${htgroup} ${ocpath}/updater</span>
<span class="x">fi</span>

<span class="x">if [ &quot;$chmdir&quot; = &quot;n&quot; ] &amp;&amp; [ &quot;$uselinks&quot; = &quot;n&quot; ]; then</span>
<span class="x">  printf &quot;chown data and apps-external directories (mkdir) \n&quot;</span>
<span class="x">  chown -R ${htuser}:${htgroup} ${ocapps_external}/</span>
<span class="x">  chown -R ${htuser}:${htgroup} ${ocdata}/</span>
<span class="x">fi</span>
<span class="x">if [ &quot;$chmdir&quot; = &quot;y&quot; ] &amp;&amp; [ &quot;$uselinks&quot; = &quot;y&quot; ]; then</span>
<span class="x">  printf &quot;chown data and apps-external directories (linked) \n&quot;</span>
<span class="x">  chown -R ${htuser}:${htgroup} ${ocapps_external}/</span>
<span class="x">  chown -R ${htuser}:${htgroup} ${ocdata}/</span>
<span class="x">fi</span>

<span class="x">printf &quot;\nchmod occ command to make it executable \n&quot;</span>
<span class="x">if [ -f ${ocpath}/occ ]; then</span>
<span class="x">  chmod +x ${ocpath}/occ</span>
<span class="x">fi</span>

<span class="x">printf &quot;chmod/chown .htaccess \n&quot;</span>
<span class="x">if [ -f ${ocpath}/.htaccess ]; then</span>
<span class="x">  chmod 0644 ${ocpath}/.htaccess</span>
<span class="x">  chown ${rootuser}:${htgroup} ${ocpath}/.htaccess</span>
<span class="x">fi</span>
<span class="x">if [ -f ${ocdata}/.htaccess ];then</span>
<span class="x">  chmod 0644 ${ocdata}/.htaccess</span>
<span class="x">  chown ${rootuser}:${htgroup} ${ocdata}/.htaccess</span>
<span class="x">fi</span>
<span class="x">echo</span>
</pre></div>
</div>
<p>If you have customized your ownCloud installation and your file paths are different than the standard installation, modify this script accordingly.</p>
<p>This summary lists the recommended modes and ownership for your ownCloud directories and files:</p>
<ul class="simple">
<li>All files should be read-write for the file owner, read-only for the group owner, and zero for the world</li>
<li>All directories should be executable (because directories always need the executable bit set), read-write for the directory owner, and read-only for the group owner</li>
<li>The <code class="file docutils literal notranslate"><span class="pre">apps/</span></code> directory should be owned by <code class="docutils literal notranslate"><span class="pre">[HTTP</span> <span class="pre">user]:[HTTP</span> <span class="pre">group]</span></code></li>
<li>The <code class="file docutils literal notranslate"><span class="pre">apps-external/</span></code> directory should be owned by <code class="docutils literal notranslate"><span class="pre">[HTTP</span> <span class="pre">user]:[HTTP</span> <span class="pre">group]</span></code></li>
<li>The <code class="file docutils literal notranslate"><span class="pre">config/</span></code> directory should be owned by <code class="docutils literal notranslate"><span class="pre">[HTTP</span> <span class="pre">user]:[HTTP</span> <span class="pre">group]</span></code></li>
<li>The <code class="file docutils literal notranslate"><span class="pre">data/</span></code> directory should be owned by <code class="docutils literal notranslate"><span class="pre">[HTTP</span> <span class="pre">user]:[HTTP</span> <span class="pre">group]</span></code></li>
<li>The <code class="file docutils literal notranslate"><span class="pre">updater/</span></code> directory should be owned by <code class="docutils literal notranslate"><span class="pre">[HTTP</span> <span class="pre">user]:[HTTP</span> <span class="pre">group]</span></code></li>
<li>The <code class="file docutils literal notranslate"><span class="pre">[ocpath]/.htaccess</span></code> file should be owned by <code class="docutils literal notranslate"><span class="pre">root:[HTTP</span> <span class="pre">group]</span></code></li>
<li>The <code class="file docutils literal notranslate"><span class="pre">data/.htaccess</span></code> file should be owned by <code class="docutils literal notranslate"><span class="pre">root:[HTTP</span> <span class="pre">group]</span></code></li>
<li>Both <code class="file docutils literal notranslate"><span class="pre">.htaccess</span></code> files are read-write file owner, read-only group and
world</li>
</ul>
<p>These strong permissions prevent upgrading your ownCloud server; see <a class="reference internal" href="../maintenance/update.html#set-updating-permissions-label"><span class="std std-ref">Setting Permissions for Updating</span></a> for a script to quickly change permissions to allow upgrading.</p>
</div>
</div>


					</div>
				</div>
			</div>

  </div>
</div>
</div>
<footer class="footer">
  <div class="container">
  <div class="footer_navi">

  <div class="menu-footer-navigation-container">
  	<ul id="menu-footer-navigation" class="menu">
  		<li><a href="https://owncloud.com">Home</a></li>
  		<li><a href="https://owncloud.com/about">About ownCloud</a></li>
  		<li><a href="https://owncloud.com/resources">Resources</a></li>
  		<li><a href="https://owncloud.com/become-partner">Become a Partner</a></li>
  		<li><a href="https://owncloud.org">Community</a></li>
  		<li><a href="https://owncloud.com/blog">Blog</a></li>
  		<li><a href="https://owncloud.com/jobs">Jobs</a></li>
  		<li><a href="https://owncloud.com/contact">Contact</a></li>
  	</ul>
  </div>

  <div class="follow_f">
  	<ul>
  		<li><a class="twitter" href="https://twitter.com/ownloud" target="_blank">Twitter</a></li>
  		<li><a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a></li>
  		<li><a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a></li>
  	</ul>
  </div>

  <p class="copyright">© ownCloud 2011-2015</p>

  </div>
  </div>
</footer>
  </body>
</html>