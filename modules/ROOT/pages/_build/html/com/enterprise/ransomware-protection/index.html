
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Ransomware Protection &#8212; ownCloud 10.0.7 Server Administration Manual 10.0.7 documentation</title>
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/responsive.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="File Management" href="../file_management/index.html" />
    <link rel="prev" title="File Firewall" href="../firewall/file_firewall.html" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript">
(function () {
  /**
   * Patch TOC list.
   *
   * Will mutate the underlying span to have a correct ul for nav.
   *
   * @param $span: Span containing nested UL's to mutate.
   * @param minLevel: Starting level for nested lists. (1: global, 2: local).
   */
  var patchToc = function ($ul, minLevel) {
    var findA;

    // Find all a "internal" tags, traversing recursively.
    findA = function ($elem, level) {
      var level = level || 0,
        $items = $elem.find("> li > a.internal, > ul, > li > ul");

      // Iterate everything in order.
      $items.each(function (index, item) {
        var $item = $(item),
          tag = item.tagName.toLowerCase(),
          pad = 15 + ((level - minLevel) * 10);

        if (tag === 'a' && level >= minLevel) {
          // Add to existing padding.
          $item.css('padding-left', pad + "px");
          console.log(level, $item, 'padding-left', pad + "px");
        } else if (tag === 'ul') {
          // Recurse.
          findA($item, level + 1);
        }
      });
    };

    console.log("HERE");
    findA($ul);
  };

  $(document).ready(function () {
    // Add styling, structure to TOC's.
    $(".dropdown-menu").each(function () {
      $(this).find("ul").each(function (index, item){
        var $item = $(item);
        $item.addClass('unstyled');
      });
      $(this).find("li").each(function () {
        $(this).parent().append(this);
      });
    });

    // Patch in level.
    patchToc($("ul.globaltoc"), 2);
    patchToc($("ul.localtoc"), 2);

    // Enable dropdown.
    $('.dropdown-toggle').dropdown();
  });
}());
</script>

<!-- Piwik -->
<script type="text/javascript">
  var _paq = _paq || [];
  /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="https://piwik.owncloud.com/";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', '4']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<!-- End Piwik Code -->

  </head><body>
  

<noscript><p><img src="https://piwik.owncloud.com/piwik.php?idsite=4&rec=1" style="border:0" alt=""></p></noscript>
<div class="header_con">
<div class="container">
<h1 id="site-title"><a href="http://doc.owncloud.com" title="ownCloud" rel="home">ownCloud</a></h1>

<form class="headersearch" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>

<div class="follow">
<p><a class="visible" href="https://owncloud.com" title="ownCloud">Back to owncloud.com</a>|<span class="visible">Follow us:</span></p>
<a class="twitter" href="https://twitter.com/owncloud" target="_blank">Twitter</a>
<a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a>
<a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a>
</div>

</div>
</div>

<div id="main">
<div class="container">
  <div class="content">

    </div>
    
			<div class="row">
				<div class="span3">
					<div class="sidebar">
						<div class="box sidenavi">
							<div class="menu-support-container">
								<ul id="menu-support" class="menu">
									<ul>

<li><a href="../../contents.html">Table of Contents</a></li>
									</ul>
                  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../whats_new_admin.html">What’s New in ownCloud 10.0.7</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../upgrading/index.html">Upgrading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintenance/index.html">Maintenance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../issues/index.html">Issues and Troubleshooting</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Enterprise Features</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation/index.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../firewall/index.html">Firewall Configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Ransomware Protection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#about-ransomware-protection">About Ransomware Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prevention-blocking-common-ransomware-file-extensions">Prevention: Blocking Common Ransomware File Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#protection-data-retention-and-rollback">Protection: Data Retention and Rollback</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-elements-of-ransomware-protection">Other Elements of Ransomware Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../file_management/index.html">File Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../external_storage/index.html">External Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user_management/index.html">User Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../clients/index.html">Creating Branded ownCloud Clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging Apps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../server_branding/index.html">Server Branding</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../appliance/index.html">The ownCloud X Appliance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/index.html">FAQ</a></li>
</ul>

								</ul>
							</div>
						</div>
					</div>
				</div>
        

				<div class="span9">
					<div class="page-content">
						
  <div class="section" id="ransomware-protection">
<h1>Ransomware Protection<a class="headerlink" href="#ransomware-protection" title="Permalink to this headline">¶</a></h1>
<p>Ransomware is <a class="reference external" href="https://www.google.de/search?q=ransomware&amp;source=lnms&amp;tbm=nws&amp;sa=X&amp;ved=0ahUKEwiqmvL9rdfXAhWCyaQKHSkgDosQ_AUICigB&amp;biw=1680&amp;bih=908">an ever-present threat</a>, both for large enterprises as well as for individuals.
Once infected, a whole hard disk (or just parts of it) can become encrypted, leading to unrecoverable data loss.</p>
<p>Once this happens, attackers usually ask victims to pay a ransom, often via cryptocurrencies such as Bitcoin, in exchange for the decryption key required to decrypt their data.</p>
<p>While paying the ransom works in some cases, it is not recommended, as there is no guarantee that the attackers will supply the key after payment is made.
To help mitigate such threats and ensure ongoing access to user data, ownCloud provides the Ransomware Protection app.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">It is essential to be aware that user data needs to be synchronized with you ownCloud Server using the ownCloud Desktop synchronization client. Data that is not synchronized and stored in ownCloud cannot be protected.</p>
</div>
<div class="section" id="about-ransomware-protection">
<h2>About Ransomware Protection<a class="headerlink" href="#about-ransomware-protection" title="Permalink to this headline">¶</a></h2>
<p>The app is tasked with <em>detecting</em>, <em>preventing</em>, and <em>reverting</em> anomalies.
Anomalies are file operations (including <em>create</em>, <em>update</em>, <em>delete</em>, and <em>move</em>) not intentionally conducted by the user.
It aims to do so in two ways: <a class="reference internal" href="#ransomware-prevention-label"><span class="std std-ref">prevention</span></a>, and <a class="reference internal" href="#ransomware-protection-label"><span class="std std-ref">protection</span></a>.</p>
</div>
<div class="section" id="prevention-blocking-common-ransomware-file-extensions">
<span id="ransomware-prevention-label"></span><h2>Prevention: Blocking Common Ransomware File Extensions<a class="headerlink" href="#prevention-blocking-common-ransomware-file-extensions" title="Permalink to this headline">¶</a></h2>
<p>Like other forms of cyberattack, ransomware has a range of diverse characteristics.
On the one hand it makes them hard to detect and on the other it makes them even harder to prevent.
Recent ransomware attacks either encrypt a user’s files and add a specific file extension to them (e.g., “.crypt”), or they replace the original files with an encrypted copy and add a particular file extension.</p>
<div class="section" id="file-extension-blacklist">
<h3>File Extension Blacklist<a class="headerlink" href="#file-extension-blacklist" title="Permalink to this headline">¶</a></h3>
<p>The first line of defense against such threats is a blacklist that blocks write access to file extensions known to originate from ransomware.</p>
<p>Ransomware Protection ships with <a class="reference external" href="https://fsrm.experiant.ca">a static extension list</a> of around 1,500 file extensions.
As new extensions are regularly created, this list also needs to be regularly reviewed and updated.
Future releases of Ransomware Protection will include an updated list and the ability to update the list via syncing with <a class="reference external" href="https://fsrm.experiant.ca/api/v1/combined">FSRM’s API</a> by using <a class="reference internal" href="../../configuration/server/occ_command.html"><span class="doc">occ</span></a>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Please check the provided ransomware blacklist!
It is <strong>strongly recommended</strong> to check the provided ransomware blacklist to ensure that it fits your needs.
In some cases, the patterns might be too generic and result in false positives.</p>
</div>
</div>
<div class="section" id="file-blocking">
<h3>File Blocking<a class="headerlink" href="#file-blocking" title="Permalink to this headline">¶</a></h3>
<p>The second line of defense is file blocking.
As files are uploaded, they are compared against the file extension blacklist.
If a match is found, the upload is denied.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">File blocking is always enabled.</p>
</div>
</div>
<div class="section" id="account-locking">
<h3>Account Locking<a class="headerlink" href="#account-locking" title="Permalink to this headline">¶</a></h3>
<p>The third line of defense is account locking.
If a client uploads a file matching a pattern in the ransomware blacklist, the account is locked (set as read-only) for client access (<em>create</em>, <em>change</em>, <em>move</em>, and <em>delete</em> operations).
Doing this prevents further, malicious, changes.</p>
<p>Following this, clients receive an error (403 Access Forbidden) which notifies the user that the account is locked by Ransomware Protection.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Write access (e.g., moving and deleting files) is still possible for users when they log in with their web browser.</p>
</div>
<p>When an account is locked, administrators can unlock the account using the <code class="docutils literal notranslate"><span class="pre">occ</span> <span class="pre">ransomguard:unlock</span></code> command.
Administrators can also manually lock user accounts, using the <code class="docutils literal notranslate"><span class="pre">occ</span> <span class="pre">ransomguard:lock</span></code> command.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When an account is locked, it will still be fully usable from the ownCloud web UI.
However, ownCloud clients (as well as other WebDAV clients) will see the account as set to read-only mode.</p>
</div>
<p>Users will see a yellow notification banner in the ownCloud web UI directing them to “Personal Settings -&gt; Security” (“<em>Ransomware detected: Your account is locked (read-only) for client access to protect your data. Click here to unlock.</em>”), where additional information is displayed and users can unlock their account when ransomware issues are resolved locally.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Locking is enabled by default. If this is not desired, an administrator can disable it in the “Admin -&gt; Security” panel.</p>
</div>
</div>
</div>
<div class="section" id="protection-data-retention-and-rollback">
<span id="ransomware-protection-label"></span><h2>Protection: Data Retention and Rollback<a class="headerlink" href="#protection-data-retention-and-rollback" title="Permalink to this headline">¶</a></h2>
<p>While Ransomware Prevention mitigates risks of a range of ransomware attacks, it is not a future-proof solution, because ransomware is becoming ever-more sophisticated.
There are known attacks that change file extensions randomly or keep them unchanged which makes them harder to detect.</p>
<p>Ultimately there is a consensus that only one solution can provide future-proof protection from ransomware attacks: retaining data and providing the means to roll back to a particular point in time.</p>
<p>ownCloud Ransomware Protection will, therefore, record all changes on an ownCloud Server and allow administrators to rollback user data to a particular point in time, making use of ownCloud’s integrated Versioning and Trash bin features.</p>
<p>Doing so allows all user data that is synchronized with the server to be rolled back to its state before the attack occurred.
A combination of Ransomware prevention and protection reduces risks to a minimum acceptable level.</p>
</div>
<div class="section" id="other-elements-of-ransomware-protection">
<h2>Other Elements of Ransomware Protection<a class="headerlink" href="#other-elements-of-ransomware-protection" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="35%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Command (if applicable)</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Ransomware Prevention (Blocker)</td>
<td>&#160;</td>
<td>First line of defense against ransomware attacks.
Ransomware Protection uses a file name pattern blacklist
to prevent uploading files that have file extensions
associated with ransomware (e.g. “.crypt”) thereby
preserving the original files on the ownCloud Server.</td>
</tr>
<tr class="row-odd"><td>Ransomguard Scanner</td>
<td><code class="docutils literal notranslate"><span class="pre">occ</span> <span class="pre">ransomguard:scan</span> <span class="pre">&lt;timestamp&gt;</span> <span class="pre">&lt;user&gt;</span></code></td>
<td>A command to scan the ownCloud database for
changes in order to discover anomalies in a
user’s account and their origin. It enables an
administrator to determine the point in time
where undesired actions happened as a
prerequisite for restoration.</td>
</tr>
<tr class="row-even"><td>Ransomguard Restorer</td>
<td><code class="docutils literal notranslate"><span class="pre">occ</span> <span class="pre">ransomguard:restore</span> <span class="pre">&lt;timestamp&gt;</span> <span class="pre">&lt;user&gt;</span></code></td>
<td>A command for administrators to revert all
operations in a user account that occurred after
a certain point in time.</td>
</tr>
<tr class="row-odd"><td>Ransomguard Lock</td>
<td><code class="docutils literal notranslate"><span class="pre">occ</span> <span class="pre">ransomguard:lock</span> <span class="pre">&lt;user&gt;</span></code></td>
<td>Set a user account as read-only for ownCloud and other
WebDAV clients. This prevents any further changes to
the account.</td>
</tr>
<tr class="row-even"><td>Ransomguard Unlock</td>
<td><code class="docutils literal notranslate"><span class="pre">occ</span> <span class="pre">ransomguard:unlock</span> <span class="pre">&lt;user&gt;</span></code></td>
<td>Unlock a user account which was set to read-only.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">&lt;timestamp&gt;</span></code> must be in <cite>the Linux timestamp format</cite>.</p>
</div>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mandatory">
<h3>Mandatory<a class="headerlink" href="#mandatory" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><strong>File Firewall rule (previous approach for ransomware protection).</strong> If you have configured the File Firewall rule which was provided as a preliminary protection mechanism, please remove it. The functionality (Blocking) is covered by Ransomware Protection in an improved way.</li>
<li><strong>Ransomware Protection.</strong> Ransomware protection needs to be in operation before an attack occurs, as it needs to record file operations to be able to revert them, in case of an attack.</li>
<li><strong>ownCloud Versions App.</strong> Required to restore older file versions. The capabilities of Ransomware Protection depend on its configuration regarding version retention.</li>
<li><strong>ownCloud Trash Bin App.</strong> Required to restore deleted files. The capabilities of Ransomware Protection depend on its configuration regarding trash bin retention.</li>
</ol>
</div>
<div class="section" id="optional">
<h3>Optional<a class="headerlink" href="#optional" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><strong>Activity app.</strong> For viewing activity logs.</li>
</ol>
</div>
</div>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Ransomware Protection works with master-key based storage encryption. With credential-based storage encryption, only Ransomware Prevention (Blocking) works.</li>
<li>Rollback is not based on snapshots:<ul>
<li>The <a class="reference external" href="https://doc.owncloud.com/server/latest/admin_manual/configuration/server/config_sample_php_parameters.html?highlight=trash%20bin#deleted-items-trash-bin">trash bin retention policy</a> may delete files, making them unrecoverable. To avoid this, set <code class="docutils literal notranslate"><span class="pre">trashbin\_retention\_obligation</span></code> to <code class="docutils literal notranslate"><span class="pre">disabled</span></code>, or choose a conservative policy for trash bin retention. However, please be aware that this may increase storage requirements.</li>
<li>Trash bin items may be deleted by the user making them unrecoverable by Ransomware Protection =&gt; Users need to know this.</li>
<li>Versions have <a class="reference external" href="https://doc.owncloud.com/server/latest/admin_manual/configuration/server/config_sample_php_parameters.html?highlight=trash%20bin#file-versions">a built-in “thin-out” policy</a> which makes it possible that required file versions are unrecoverable by Ransomware Protection. To help avoid this, set <code class="docutils literal notranslate"><span class="pre">versions\_retention\_obligation</span></code> to <code class="docutils literal notranslate"><span class="pre">disabled</span></code> or choose a conservative policy for version retention. Please be aware that this might increase your storage needs.</li>
<li>A specific version of a file that is needed for rollback might have been manually restored, making this version potentially unrecoverable by Ransomware Protection. Currently, after restoration the restored version <cite>is not a version anymore</cite>, e.g., the version is not present in versioning.</li>
</ul>
</li>
<li>Contents in secondary storages, such as <em>Windows network drives</em>, <em>Dropbox</em>, and <em>Google Drive</em>, are unrecoverable by Ransomware Protection, because they do not have versioning or trash bin enabled in ownCloud.</li>
<li>Rolling files forward is not <em>currently</em> supported or tested. Therefore it is vital to:<ul>
<li>Carefully decide the point in time to rollback to.</li>
<li>To have proper backups to be able to conduct the rollback again, if necessary.</li>
</ul>
</li>
</ul>
</div>
</div>


					</div>
				</div>
			</div>

  </div>
</div>
</div>
<footer class="footer">
  <div class="container">
  <div class="footer_navi">

  <div class="menu-footer-navigation-container">
  	<ul id="menu-footer-navigation" class="menu">
  		<li><a href="https://owncloud.com">Home</a></li>
  		<li><a href="https://owncloud.com/about">About ownCloud</a></li>
  		<li><a href="https://owncloud.com/resources">Resources</a></li>
  		<li><a href="https://owncloud.com/become-partner">Become a Partner</a></li>
  		<li><a href="https://owncloud.org">Community</a></li>
  		<li><a href="https://owncloud.com/blog">Blog</a></li>
  		<li><a href="https://owncloud.com/jobs">Jobs</a></li>
  		<li><a href="https://owncloud.com/contact">Contact</a></li>
  	</ul>
  </div>

  <div class="follow_f">
  	<ul>
  		<li><a class="twitter" href="https://twitter.com/ownloud" target="_blank">Twitter</a></li>
  		<li><a class="facebook" href="http://www.facebook.com/owncloud" target="_blank">Facebook</a></li>
  		<li><a class="google" href="https://plus.google.com/+OwncloudOfficial" target="_blank">Google</a></li>
  	</ul>
  </div>

  <p class="copyright">© ownCloud 2011-2015</p>

  </div>
  </div>
</footer>
  </body>
</html>